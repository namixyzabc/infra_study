# VMkernelポート

## 概要
**VMkernelポート**は、VMware ESXiホスト自身が通信するための専用ネットワークインターフェースです。仮想マシンではなく、**ホストOS（ESXi）が使う特別なポート**。

## 家の例えで理解する
```
[家（ESXiホスト）]
├─ 住人用の玄関（仮想マシン用ポート）← 仮想マシンが使う
└─ 管理人用の裏口（VMkernelポート）← ESXiホスト自身が使う
```

## 主な用途

### 1. **管理アクセス（Management）**
- vSphere ClientやSSHでESXiホストに接続する
- ホストの設定や監視を行う

### 2. **vMotion**
- 稼働中の仮想マシンを別のホストに移動
- 大量のメモリデータを転送

### 3. **vSAN**
- VMwareの分散ストレージ通信
- ホスト間でストレージデータをやり取り

### 4. **iSCSI**
- ネットワークストレージへの接続

### 5. **Fault Tolerance（FT）**
- 仮想マシンの完全な冗長化通信

### 6. **vSphere Replication**
- 仮想マシンのレプリケーション通信

## 構成イメージ

```
[ESXiホスト]
  │
  ├─ VMkernel0（管理） → IP: 192.168.1.10
  ├─ VMkernel1（vMotion）→ IP: 10.0.0.10
  ├─ VMkernel2（vSAN）   → IP: 172.16.0.10
  └─ 仮想スイッチで物理NICに接続
```

## 仮想マシン用ポートとの違い

| 項目 | VMkernelポート | 仮想マシン用ポート |
|------|---------------|------------------|
| **使用者** | ESXiホスト自身 | 仮想マシン |
| **用途** | 管理、vMotionなど | VM間通信、外部通信 |
| **IPアドレス** | ホストに割当 | VMに割当 |

## 設定時のポイント

### ✅ ベストプラクティス
- **トラフィック種類ごとに分離**（管理とvMotionは別ポート）
- **専用の物理NICを割当**（パフォーマンス向上）
- **適切なVLANタグ設定**（ネットワーク分離）

### ⚠️ 注意点
- 管理ポートは必須（最低1つ必要）
- IPアドレスの重複禁止
- MTUサイズの統一（特にvSAN、vMotion）

## 実際の設定例

```
名前: vmk0
用途: Management Network
IP: 192.168.1.100/24
VLAN: なし（VLAN 1）

名前: vmk1
用途: vMotion
IP: 10.10.10.100/24
VLAN: 10
MTU: 9000（Jumbo Frame）
```

## まとめ
VMkernelポートは「**ESXiホスト自身の手足**」のようなもので、管理やホスト間通信に不可欠です。用途に応じて複数作成し、適切に分離することでパフォーマンスと安全性が向上します。
