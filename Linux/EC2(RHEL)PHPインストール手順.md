
### 1. PHP最新バージョンインストールのための事前準備

最新バージョンのPHPをインストールするために、必要なリポジトリ（パッケージの保管場所）を設定します。

| コマンド | コメント |
| :--- | :--- |
| `dnf install epel-release` | PHP本体をインストールする前の事前準備として、まず`epel`リポジトリをインストールします。確認画面では`yes (Y)`で応答します。 |
| `dnf install [Remiリリースを指すURLまたはパッケージ名]` | PHPの最新バージョンに必要なファイル群が置かれている`remi`リポジトリからデータを取り込むための設定を追加します。 |
| `dnf module enable php:remi-8.3` | 通常設定（upstream）ではなく、**REMIリポジトリのPHP 8.3系**を使用するように設定を有効化します。これにより、インストールするPHPのバージョンが8.3系になります。 |

### 2. PHPと必須モジュールのインストール

ウェブアプリケーションに必要なPHP本体と関連モジュールをまとめてインストールします。

| コマンド | コメント |
| :--- | :--- |
| `dnf install php php-pdo php-mbstring php-mysqlnd php-fpm` | PHP本体、データベース接続（`php-pdo`）、マルチバイト対応（`php-mbstring`）、MySQL接続（`php-mysqlnd`）、およびPHP実行環境（`php-fpm`）をまとめてインストールします。 |
| `php -v` | インストール後、意図したバージョン（例：8.3.1.2系）が正しくインストールされているかを確認します。 |

### 3. PHP-FPMサービスの管理と自動起動設定

PHPをプログラムとして実行するため、PHP-FPM（FastCGI Process Manager）を起動し、恒久的に稼働するように設定します。

| コマンド | コメント |
| :--- | :--- |
| `systemctl start php-fpm` | PHPプログラムの実行を担うPHP-FPMサービスを起動します。 |
| `systemctl status php-fpm` | サービスがアクティブで実行されているか（`Active`状態か）を確認します。 |
| `systemctl enable php-fpm` | サーバーが再起動された際にも、PHP-FPMが自動で起動するように設定を有効化します。 |

### 4. PHP動作の確認とテストファイルのクリーンアップ

PHPとApacheが連動しているか確認した後、セキュリティのためにテストファイルを削除します。

| コマンド | コメント |
| :--- | :--- |
| `systemctl reload httpd` | PHPをインストールした後、Apacheに設定を再読み込み（リロード）させ、PHPとの連動を確立させます。 |
| `rm /var/www/html/phpinfo.php` | ブラウザで確認後、OSや設定情報が含まれる`phpinfo.php`ファイルを、**セキュリティ上の理由から**速やかに削除します。 |

### 5. セキュリティと汎用的な設定の適用

PHPの設定ファイル（`/etc/php.ini`）を編集し、セキュリティ対策と汎用的な設定を適用します。

| コマンド | コメント |
| :--- | :--- |
| `vi /etc/php.ini` | PHPの各種設定を行うための設定ファイルを開きます。 |
| *`expose_php = Off`* (ファイル内編集) | レスポンスヘッダーを通じてPHPのバージョン情報（`X-Powered-By`）が公開されないように設定します。攻撃者への情報提供を防ぐためのセキュリティ対策です。 |
| *`date.timezone = Asia/Tokyo`* (ファイル内編集) | 必須とされる設定として、タイムゾーンの設定を探し出し、コメントアウトを外し`Asia/Tokyo`に設定します。 |
| `systemctl reload httpd` | 設定変更を反映させるため、Apacheサービスをリロードします。 |
| `systemctl reload php-fpm` | 設定変更を反映させるため、PHP-FPMサービスもリロードします。 |
