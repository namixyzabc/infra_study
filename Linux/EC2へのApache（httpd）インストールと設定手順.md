
### Apache（httpd）インストールと設定手順

#### I. 準備

| コマンド | 目的・コメント | 参照元 |
| :--- | :--- | :--- |
| `ssh -i [秘密鍵ファイルパス] ec2-user@[IPアドレス]` | EC2インスタンスにSSHで接続します。 | |
| `sudo su -` | ルートユーザー（スーパーユーザー）に昇格します。ミドルウェアのインストールは基本的にこの権限で行います。 | |

#### II. Apache（httpd）のインストール

| コマンド | 目的・コメント | 参照元 |
| :--- | :--- | :--- |
| `dnf install httpd` | **Apacheのミドルウェア名である `httpd` をインストールします。**新しいコマンド `dnf` を使用します。 | |
| `Y` | 依存関係のインストール確認（Is this ok?）に対し、`Y` を入力して続行します。 | |
| `httpd -V` | インストールされたApacheのバージョン（例: 2.4.62など）を確認します。 | |

#### III. 起動と自動起動の設定

| コマンド | 目的・コメント | 参照元 |
| :--- | :--- | :--- |
| `systemctl start httpd` | **Apacheサービスを起動します**。 | |
| `systemctl status httpd` | 起動状態を確認します。「Active (running)」となっていれば正常に起動しています。 | |
| `systemctl enable httpd` | **OS再起動時にApacheが自動的に起動するように設定します。**インストールと起動とセットで実施することが推奨されます。 | |

#### IV. セキュリティ設定（ファイアウォール）

（**AWSマネジメントコンソール上での作業**：EC2インスタンスに紐づくセキュリティグループのインバウンドルールを編集します。）

| アクション | 目的・コメント | 参照元 |
| :--- | :--- | :--- |
| インバウンドルールの確認 | 現状、SSH（22番ポート）のみが許可されています。 | |
| HTTP (80番ポート) の追加 | Webサーバーが使用するHTTP接続を許可します。 | |
| HTTPS (443番ポート) の追加 | Webサーバーが使用するHTTPS接続を許可します。 | |

*注: この設定により、IPアドレスにアクセスした際に「Alma Linux Test Page」が表示されるようになります。*

#### V. 推奨セキュリティ対策（バージョン情報の非表示化）

| コマンド | 目的・コメント | 参照元 |
| :--- | :--- | :--- |
| `vi /etc/httpd/conf/httpd.conf` | Apacheのメイン設定ファイルを開きます。 | |
| `ServerTokens Prod` を追記/変更 | **レスポンスヘッダーにApacheのバージョン情報やOS情報が表示されるのを防ぎます。**デフォルトの「Full」設定から制限します。 | |
| `httpd -t` | 設定ファイル（httpd.conf）の構文チェックを行います。「Syntax OK」が出たら記述ミスはありません。 | |
| `systemctl reload httpd` | 設定ファイルを再読み込み（リロード）し、設定を反映させます。 | |

#### VI. Webコンテンツの配置（任意）

| コマンド | 目的・コメント | 参照元 |
| :--- | :--- | :--- |
| `cd /var/www/html` | Webコンテンツを配置するディレクトリに移動します。デフォルトの設定では、このフォルダ内のファイルが表示されます。 | |
| `vi index.html` | テスト用のHTMLファイルを作成・編集します。 | |
| `[HTML内容を記述]` | VIで `i` キーを押してインサートモードに入り、コンテンツを記述します。 | |
| `:wq` | 編集内容を保存（Write）して終了（Quit）します。 | |
