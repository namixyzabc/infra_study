# IPアドレスのサブネットマスク解説

## IPアドレスとは

IPアドレスは、ネットワーク上の機器を識別する32ビット（IPv4の場合）の数値です。通常は「192.168.1.1」のように4つの数値をドット（.）で区切って表記します。

## サブネットマスクの基本概念

**サブネットマスク**は、IPアドレスの「ネットワーク部」と「ホスト部」を区別するための仕組みです。

- **ネットワーク部**：どのネットワークに属するかを示す
- **ホスト部**：そのネットワーク内での個別の機器を識別する

### 表記方法

**CIDR記法**：`192.168.1.1/24`
**サブネットマスク記法**：`255.255.255.0`

## グローバルIPアドレスでのサブネット

### 特徴
- インターネット上で一意に識別される
- ISP（インターネットサービスプロバイダー）から割り当てられる
- 直接インターネットからアクセス可能

### 例：企業ネットワーク
```
IPアドレス：203.0.113.0/24
サブネットマスク：255.255.255.0
ネットワーク部：203.0.113（24ビット）
ホスト部：0（8ビット）
利用可能ホスト数：254台（203.0.113.1〜203.0.113.254）
```

### サブネット分割例
大きなグローバルIPブロックを分割する場合：
```
元のネットワーク：203.0.113.0/24

分割後：
- 203.0.113.0/26   →  203.0.113.1〜203.0.113.62（62台）
- 203.0.113.64/26  →  203.0.113.65〜203.0.113.126（62台）
- 203.0.113.128/26 →  203.0.113.129〜203.0.113.190（62台）
- 203.0.113.192/26 →  203.0.113.193〜203.0.113.254（62台）
```

## ローカルIPアドレス（プライベートIP）でのサブネット

### 特徴
- 組織内でのみ使用される
- インターネットでは直接ルーティングされない
- **RFC1918**で定義された範囲内で使用

### プライベートIP範囲
```
クラスA：10.0.0.0/8        （10.0.0.0〜10.255.255.255）
クラスB：172.16.0.0/12     （172.16.0.0〜172.31.255.255）
クラスC：192.168.0.0/16    （192.168.0.0〜192.168.255.255）
```

### 実践例：オフィスネットワーク設計

#### 部署別サブネット分割
```
基本ネットワーク：192.168.0.0/16

部署別分割：
- 営業部：192.168.1.0/24   → 254台
- 開発部：192.168.2.0/24   → 254台
- 総務部：192.168.3.0/24   → 254台
- サーバー：192.168.10.0/24 → 254台
```

#### さらに細かい分割例
```
開発部内でのチーム分割：192.168.2.0/24

チーム別：
- フロントエンド：192.168.2.0/26   → 62台
- バックエンド：192.168.2.64/26    → 62台
- インフラ：192.168.2.128/26       → 62台
- 予備：192.168.2.192/26           → 62台
```

## サブネットマスクの計算方法

### ビット計算
```
/24の場合：
11111111.11111111.11111111.00000000
= 255.255.255.0

/26の場合：
11111111.11111111.11111111.11000000
= 255.255.255.192
```

### ホスト数の計算
**ホスト数 = 2^（32 - サブネット長）- 2**

例：
- /24：2^8 - 2 = 254台
- /26：2^6 - 2 = 62台
- /28：2^4 - 2 = 14台

## 設定例

### Windows設定
```
IPアドレス：192.168.1.100
サブネットマスク：255.255.255.0
デフォルトゲートウェイ：192.168.1.1
```

### Linux設定（ip コマンド）
```bash
# IPアドレス設定
ip addr add 192.168.1.100/24 dev eth0

# ルート設定
ip route add default via 192.168.1.1
```

## 重要なポイント

- **ネットワークアドレス**と**ブロードキャストアドレス**は機器に割り当てできない
- **サブネット分割**により、ネットワークの管理とセキュリティが向上する
- **VLSM（可変長サブネットマスク）**により、必要に応じて柔軟なサイズのサブネットを作成可能
- **グローバルIP**は有限な資源のため、効率的な使用が重要
- **ローカルIP**は組織内で自由に設計可能だが、適切な設計が運用の鍵となる

---

# 個人と企業の割り当ての違い


### 1. 個人（家庭用）のインターネット接続の場合

一般的に、家庭用のインターネット契約で割り当てられるグローバルIPアドレスは**1つだけ**です。

この場合、技術的には**`/32`（サブネットマスク `255.255.255.255`）**と表現されます。これは「ネットワーク部が32ビット全て」という意味で、そのIPアドレスただ1つだけを指し示します。ルーターのWAN（インターネット側）ポートに、この1つのIPアドレスが設定されます。

家庭で`/24`（254個の利用可能なIPアドレス）のような大きなブロックを割り当てられることは、通常ありません。

### 2. 法人（企業向け）のインターネット接続の場合

企業がサーバーを公開したり、複数の拠点と通信したりするために、**複数の固定グローバルIPアドレス**が必要になることがあります。この場合、ISPはIPアドレスのブロック（塊）を割り当てます。

このブロックの大きさが、サブネットマスク（CIDR表記）によって決まります。

*   **小規模な利用（固定IP 8個プランなど）**:
    *   `/29`（サブネットマスク `255.255.255.248`）がよく使われます。
    *   全部で8個のIPアドレス（ネットワークアドレスとブロードキャストアドレスを除く、**利用可能なIPは6個**）が含まれます。
    *   例: Webサーバー用、メールサーバー用、VPNゲートウェイ用などに使います。

*   **中規模な利用**:
    *   `/28` (利用可能IP: 14個)
    *   `/27` (利用可能IP: 30個)
    *   `/26` (利用可能IP: 62個)
    *   ...といった形で、必要な数に応じて様々なサイズのブロックが割り当てられます。

*   **大規模な利用**:
    *   **`/24` (利用可能IP: 254個)** も、もちろん企業向けのプランとして存在します。多数のサーバーを公開したり、大規模なネットワークを構築したりする際に利用されます。

### なぜ「/24」がよく話題に上がるのか？

では、なぜ「/24」という数字をよく目にするのでしょうか。これには2つの理由が考えられます。

1.  **学習の基本単位だから**:
    `/24`は、IPアドレスの最後の8ビットだけがホスト部となるため、10進数でも理解しやすく、ネットワーク学習の基本として最もよく使われる例です。クラスCという昔の分類の名残でもあります。

2.  **ローカルIPアドレス（LAN側）の設定と混同しやすいから**:
    家庭やオフィスの**ローカルネットワーク（LAN）側**では、`192.168.1.0/24` のように、`/24`がデフォルト設定として非常によく使われます。この身近なLAN側の設定と、ISPから割り当てられるグローバルIP側の設定を混同してしまうことがあります。

### まとめ

*   **個人向け**: 通常、グローバルIPは1つ（**/32**）だけ割り当てられます。
*   **法人向け**: 契約に応じて、**/29, /28, /27** など、様々なサイズのブロックが割り当てられます。もちろん**/24**も選択肢の一つです。
*   **「必ず/24」ということは全くなく、ケースバイケース**です。
