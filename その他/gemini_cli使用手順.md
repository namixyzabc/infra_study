
## 目次

1.  **はじめに**
    *   Gemini CLIとは
    *   前提条件と準備
2.  **インストールと起動**
    *   インストールの手順
    *   基本の起動方法
3.  **認証セットアップ（最初の一歩）**
    *   Googleアカウントでログイン（推奨）
    *   APIキーを使用する場合
    *   Google Cloud Vertex AIを使用する場合
4.  **基本的な使い方**
    *   チャットの開始と終了
    *   VSCの統合ターミナルでの操作
    *   ショートカットキー一覧
5.  **コマンド機能の活用**
    *   スラッシュコマンド (`/`) - 設定や操作
    *   アットマークコマンド (`@`) - ファイル読み込み
    *   感嘆符コマンド (`!`) - シェル実行
6.  **プロジェクトの記憶と文脈（コンテキスト）**
    *   `GEMINI.md` ファイルによる指示出し
    *   メモリの階層構造
    *   `.geminiignore` によるファイル除外
7.  **便利な機能**
    *   チェックポイント（変更の取り消し）
    *   セッション管理（会話の再開）
    *   カスタムコマンドの作成
8.  **設定とカスタマイズ**
    *   設定ファイル (`settings.json`)
    *   テーマの変更
    *   信頼されたフォルダー (Trusted Folders)
9.  **高度な利用方法**
    *   ヘッドレスモード（自動化・スクリプト）
    *   サンドボックス（安全な実行環境）
10. **トラブルシューティングとアンインストール**

---

## 1. はじめに

### Gemini CLIとは
Gemini CLIは、Googleの高性能AI「Gemini」を、コマンドライン（ターミナル）から直接利用できるツールです。
チャットをするだけでなく、プロジェクト内のファイルを読み込ませてコードの修正案を出させたり、Gitのコミットメッセージを自動生成させたり、ターミナル上でコマンドを実行させたりすることができます。

### 前提条件と準備
WindowsでGemini CLIを使用するには、以下の準備が必要です。

1.  **Node.jsのインストール**: Gemini CLIはNode.jsで動作します。公式サイトから「LTS（推奨版）」をダウンロードしてインストールしてください。
2.  **Visual Studio Code (VSC)**: 本手順書では、エディタとしてVSCを使用することを前提としています。

---

## 2. インストールと起動

VSCを開き、上部メニューの `ターミナル` > `新しいターミナル` をクリックしてターミナルパネルを開きます。

### インストールの手順
以下のコマンドを入力し、Enterキーを押してインストールします。

```powershell
npm install -g @google/gemini-cli
```
※ `-g` はグローバルインストールの意味で、PC内のどこからでも `gemini` コマンドが使えるようになります。

### 基本の起動方法
インストール完了後、ターミナルで以下を入力します。

```powershell
gemini
```
これでGemini CLIが起動します。初回は認証画面が表示されます。

---

## 3. 認証セットアップ（最初の一歩）

Gemini CLIを使用するには、Googleアカウントとの連携が必要です。状況に合わせて認証方法を選んでください。

### 方法A: Googleアカウントでログイン（推奨）
個人のGoogleアカウント（無料版、またはGemini Advancedなどの有料版）を使用している方に最適です。

1.  ターミナルで `gemini` を入力して起動します。
2.  認証方法の選択肢が表示されたら、矢印キーで **[Login with Google]** を選び、Enterを押します。
3.  ブラウザが自動的に開き、Googleのログイン画面が表示されます。
4.  画面の指示に従ってログインを許可してください。
5.  認証が成功すると、認証情報はローカルに保存され、次回以降は自動的にログインされます。

> **注意:** Google AI ProやUltraのサブスクリプションをお持ちの方は、その契約に紐付いたアカウントでログインしてください。

### 方法B: Gemini APIキーを使用する
Googleアカウントでログインしたくない場合や、特定のAPIキーを使いたい場合の手順です。

1.  [Google AI Studio](https://aistudio.google.com/app/apikey) にアクセスし、APIキーを取得します。
2.  VSCのターミナルで環境変数を設定します（一時的な設定）。
    ```powershell
    $env:GEMINI_API_KEY="あなたのAPIキー"
    ```
3.  `gemini` コマンドで起動し、**[Use Gemini API key]** を選択します。

### 方法C: Google Cloud Vertex AIを使用する
企業や学校のアカウント、またはGoogle Cloudを使用している上級者向けです。

1.  Google Cloudプロジェクトを作成し、Vertex AI APIを有効にします。
2.  `gcloud` CLIがインストールされている場合は、以下でログインします。
    ```powershell
    gcloud auth application-default login
    ```
3.  環境変数を設定します。
    ```powershell
    $env:GOOGLE_CLOUD_PROJECT="プロジェクトID"
    $env:GOOGLE_CLOUD_LOCATION="us-central1" # などのリージョン
    ```
4.  `gemini` を起動し、**[Vertex AI]** を選択します。

---

## 4. 基本的な使い方

認証が完了すると、対話型のプロンプトが表示されます。

### チャットの開始
プロンプトに質問や指示を入力してEnterを押すだけです。

**例:**
```text
> TypeScriptで配列をソートする関数を書いて
```

### モデルの選択
使用するAIモデルを変更したい場合は、`/model` コマンドを使用します。

*   **Auto (推奨):** タスクに応じて自動選択（基本はこれを選びます）
*   **Pro:** 複雑な推論が必要な場合（Gemini 1.5 Proなど）
*   **Flash:** 速度優先の場合（Gemini 1.5 Flashなど）

### VSCの統合ターミナルでの操作
VSCのターミナルでGemini CLIを使う利点は、エディタと直結していることです。生成されたコードをすぐにファイルにコピーしたり、後述する `@` コマンドで編集中のファイルを読み込ませたりできます。

### 終了方法
CLIを終了するには以下のいずれかを行います。
*   コマンド `/quit` または `/exit` を入力
*   キーボードで `Ctrl + C` を押す（2回押すと強制終了）
*   キーボードで `Ctrl + D` を押す（入力が空の時）

### 主要なショートカットキー一覧

| 動作 | Windows キー操作 |
| :--- | :--- |
| **送信** | `Enter` |
| **改行** (送信せずに) | `Ctrl + Enter` または `Shift + Enter` |
| **履歴を戻る** (前の入力) | `↑` または `Ctrl + P` |
| **画面クリア** | `Ctrl + L` |
| **候補選択** | `Tab` または `Enter` |
| **中断 / キャンセル** | `Ctrl + C` |
| **元に戻す (Undo)** | `Ctrl + Z` |
| **やり直す (Redo)** | `Ctrl + Shift + Z` |

---

## 5. コマンド機能の活用

Gemini CLIには3種類の特殊コマンドがあります。

### 1. スラッシュコマンド (`/`)
Gemini CLI自体の設定や操作を行うコマンドです。

*   `/help` または `/?`: ヘルプを表示します。
*   `/clear`: 画面のログを消去します。
*   `/model`: AIモデルを選択・変更します。
*   `/settings`: 設定画面を開きます（マウスや矢印キーで設定変更可能）。
*   `/theme`: 配色テーマを変更します（Dark/Lightなど）。
*   `/resume`: 過去の会話履歴（セッション）を探して再開します。
*   `/restore`: AIによるファイル変更を取り消します（チェックポイント機能）。

### 2. アットマークコマンド (`@`)
**これが最も強力な機能です。** ファイルやディレクトリの中身をAIに読み込ませます。

*   **単一ファイル:** `@ファイルパス`
    *   例: `@src/app.ts このコードのバグを見つけて`
*   **ディレクトリ:** `@ディレクトリパス`
    *   例: `@src/components/ このフォルダ内のReactコンポーネントを要約して`
    *   ※ `.gitignore` に書かれているファイル（node_modulesなど）は自動的に除外されます。
*   **そのまま送信:** 単独の `@`
    *   記号としての「@」について話したい場合に使用します。

### 3. 感嘆符コマンド (`!`)
ターミナル（シェル）コマンドを実行します。

*   **コマンド実行:** `!コマンド`
    *   例: `!dir` (ファイル一覧を表示)
    *   例: `!git status` (Gitの状態を確認)
*   **シェルモード切替:** `!` のみ入力してEnter
    *   通常のシェルモードとGeminiチャットモードを切り替えます。

> **注意:** `!` コマンドで実行される操作は、あなたの権限でPC上で直接実行されます。

---

## 6. プロジェクトの記憶と文脈（コンテキスト）

AIにプロジェクト固有のルール（コーディング規約など）を教えることで、回答の精度を劇的に向上させることができます。

### `GEMINI.md` ファイル
プロジェクトのルートディレクトリ（一番上の階層）に `GEMINI.md` というファイルを作成し、そこにルールを記述します。Gemini CLIは自動的にこのファイルを読み込み、全ての会話の前提知識として使用します。

**記述例 (`GEMINI.md`):**
```markdown
# プロジェクト: 私のWebアプリ

## ルール
- 言語はTypeScriptを使用してください。
- インデントはスペース2つです。
- 変数名はキャメルケースを使用してください。
```

### メモリの階層構造
`GEMINI.md` は階層的に読み込まれます。
1.  **グローバル:** ユーザーのホームディレクトリ (`~/.gemini/GEMINI.md`)
    *   全プロジェクト共通のルール
2.  **プロジェクトルート:** 現在のプロジェクトの直下
    *   そのプロジェクト固有のルール
3.  **サブディレクトリ:** 作業中のフォルダ内
    *   特定の機能に関するルール

コマンド `/memory show` で現在読み込まれているルールを確認でき、`/memory refresh` で再読み込みできます。

### `.geminiignore` によるファイル除外
AIに読み込ませたくないファイル（APIキーが含まれるファイルや巨大なログなど）は、`.geminiignore` ファイルを作成して記述します。書き方は `.gitignore` と同じです。

**記述例 (`.geminiignore`):**
```text
secret-keys.txt
logs/
*.tmp
```

---

## 7. 便利な機能

### チェックポイント（変更の取り消し）
AIがファイルを書き換えたり修正したりする直前に、Gemini CLIは自動的に「チェックポイント（スナップショット）」を作成します。
もしAIの修正が気に入らない場合、以下のコマンドで元に戻せます。

1.  `/restore` と入力してEnter。
2.  戻したい時点のチェックポイントを選択。
3.  ファイルの状態と会話履歴が元に戻ります。

※ この機能を使うには `settings.json` で有効化する必要があります（後述）。

### セッション管理（会話の再開）
Gemini CLIは会話を自動保存しています。作業を中断しても、後から再開可能です。

*   **一覧表示と再開:** `/resume` コマンドを実行すると、過去の会話リストが表示されます。選択してEnterで再開します。
*   **コマンドラインから:** 起動時に `gemini --resume` とすると、直前の会話を即座に再開できます。

### カスタムコマンドの作成
よく使う長いプロンプトを短いコマンドに登録できます。

1.  `<プロジェクトルート>/.gemini/commands/` フォルダを作成します。
2.  その中に `.toml` ファイルを作成します（例: `fix.toml`）。
3.  以下のように記述します。

```toml
# fix.toml
description = "コードのバグ修正を依頼する"
prompt = """
あなたは優秀なデバッグ担当です。
以下のコードのバグを見つけて修正案を出してください。

{{args}}
"""
```
これで、Gemini CLI上で `/fix @script.js` のように使うことができます。

---

## 8. 設定とカスタマイズ

### 設定ファイル (`settings.json`)
設定は `/settings` コマンドでGUIライクに変更できますが、ファイルを直接編集することも可能です。
Windowsの場合、通常 `C:\Users\ユーザー名\.gemini\settings.json` にあります。

**おすすめ設定例:**
```json
{
  "ui": {
    "theme": "Dark",         // テーマ設定
    "showLineNumbers": true  // 行番号を表示
  },
  "general": {
    "checkpointing": {
      "enabled": true        // チェックポイント機能を有効化
    }
  },
  "tools": {
    "autoAccept": false      // AIによるツール実行を自動許可するか（false推奨）
  }
}
```

### テーマの変更
`/theme` コマンドを実行すると、GitHub Dark, Dracula, Visual Studioなど、VSCユーザーに馴染みのあるテーマに変更できます。

### 信頼されたフォルダー (Trusted Folders)
セキュリティのため、初めて開くプロジェクトでは「このフォルダーを信頼しますか？」という確認が出ます。
*   **Trust folder:** このフォルダーを信頼し、全機能を有効化します。
*   **Don't trust:** 制限モード（Safe Mode）で起動します。設定ファイルや拡張機能が無効化されます。

設定は `~/.gemini/trustedFolders.json` に保存されます。`/permissions` コマンドで変更可能です。

---

## 9. 高度な利用方法

### ヘッドレスモード（自動化）
対話画面を開かずに、コマンドライン引数だけでAIを使用できます。パイプ処理が可能です。

**例: READMEを要約させる**
```powershell
Get-Content README.md | gemini --prompt "この内容を3行で要約して"
```

**例: JSON形式で出力させる**
スクリプトで処理しやすいJSON形式で結果を受け取れます。
```powershell
gemini -p "フランスの首都は？" --output-format json
```

### サンドボックス
AIが実行するコマンドやファイル操作を隔離された環境（Dockerコンテナなど）で行う機能です。安全性を高めたい場合に使用します。
使用するにはDockerがインストールされている必要があります。

*   起動時に `gemini --sandbox` フラグを付けます。
*   または `settings.json` で `"tools": { "sandbox": "docker" }` と設定します。

---

## 10. トラブルシューティングとアンインストール

### よくある問題
*   **Q: 認証がうまくいかない**
    *   A: ブラウザのキャッシュをクリアするか、APIキー認証を試してください。
*   **Q: ファイルを読み込まない**
    *   A: `.gitignore` や `.geminiignore` に含まれていないか確認してください。
*   **Q: 文字化けする**
    *   A: VSCのターミナルのエンコーディングがUTF-8になっているか確認してください。また、WindowsのPowerShellを使用している場合、古いバージョンだと表示が崩れることがあります。Windows Terminalの使用を推奨します。

### アンインストール方法
Gemini CLIを削除したい場合は、以下のコマンドを実行します。

```powershell
npm uninstall -g @google/gemini-cli
```
※ `npx` で一時的に利用していた場合は、npmキャッシュ (`%LocalAppData%\npm-cache\_npx`) を削除することでクリアできます。

---

