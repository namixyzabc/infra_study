
### 第1章: NIST SP800-171とは何か？

まず、NIST SP800-171がどのような文書なのか、その背景と目的から理解していきましょう。

#### 1.1 NISTとSP800シリーズ

*   **NIST (National Institute of Standards and Technology / アメリカ国立標準技術研究所)**
    NISTは、米国の商務省に属する技術標準に関する研究機関です。科学技術の分野で、計測や標準化を推進する役割を担っています。ITやサイバーセキュリティの分野では、世界的に参照される多くのガイドラインやフレームワークを策定・公開しており、その影響力は米国政府内に留まりません。

*   **SP (Special Publication / スペシャル・パブリケーション)**
    NISTが発行する文書シリーズの一つで、特にコンピュータセキュリティ関連のガイドラインや研究報告が多く含まれています。SP800シリーズは、その中でも情報セキュリティに特化した文書群です。例えば、以下のような有名な文書があります。
    *   **NIST SP800-53:** 連邦政府情報システムのためのセキュリティ管理策とプライバシー管理策のカタログ。非常に詳細で網羅的な管理策がリストアップされています。
    *   **NIST Cybersecurity Framework (CSF):** 組織のサイバーセキュリティリスクを管理・低減するためのフレームワーク。重要インフラ事業者などで広く採用されています。

#### 1.2 NIST SP800-171の目的と対象

NIST SP800-171の正式名称は「**Protecting Controlled Unclassified Information in Nonfederal Systems and Organizations**」（非連邦政府組織およびシステムにおける管理対象非機密情報（CUI）の保護）です。

この名称から分かる通り、この文書の**最大の目的は「CUI」を保護すること**です。

*   **CUI (Controlled Unclassified Information / 管理対象非機密情報)**
    CUIとは、連邦政府が作成または保有する情報のうち、法律、規制、または政府全体の方針によって保護や適切な取り扱いが求められる**機密指定されていない情報**のことです。
    *   **「機密情報 (Classified Information)」ではない:** 国家安全保障に関わる「Confidential（秘）」「Secret（極秘）」「Top Secret（最高機密）」といったレベルの情報とは区別されます。
    *   **しかし「公開情報」でもない:** 一般に公開して良い情報ではなく、特定の目的のために管理・保護される必要があります。
    *   **具体例:** 技術図面、研究データ、法執行に関する情報、個人情報、契約情報、インフラ情報など、多岐にわたります。

SP800-171が対象とするのは、これらのCUIを取り扱う「**非連邦政府組織**」、つまり民間企業や大学、研究機関などです。特に、米国国防総省（DoD）をはじめとする連邦政府機関と取引があり、契約の過程でCUIを受け取ったり、作成したりする組織が準拠を求められます。

#### 1.3 なぜSP800-171が重要なのか？

米国政府は、自らの機密情報を守るだけでなく、サプライチェーン全体での情報漏洩リスクを非常に深刻に捉えています。政府機関本体のセキュリティが強固でも、取引先の民間企業のセキュリティが脆弱であれば、そこが攻撃の標的（**サプライチェーン攻撃**）となり、結果として政府の重要な情報（CUI）が漏洩する可能性があるからです。

このサプライチェーン全体のセキュリティレベルを底上げするために、**政府と取引する企業に対して「CUIを保護するための統一的なセキュリティ基準」としてSP800-171への準拠を義務付けた**のです。

#### 1.4 SP800-53との関係

SP800-171を理解する上で、SP800-53との関係を知ることは非常に重要です。

*   **SP800-53:** 連邦政府機関向けの**包括的なセキュリティ管理策のカタログ**です。非常に詳細で数百もの管理策が含まれており、実装には多大なコストと労力がかかります。
*   **SP800-171:** 民間企業がCUIを保護するために実装すべきセキュリティ要件をまとめたものです。実は、**SP800-171のセキュリティ要件は、SP800-53の中から「CUIの機密性保護」に焦点を当てて抽出・調整されたサブセット**になっています。

政府機関と同じレベルの厳格さを民間企業にそのまま求めるのは現実的ではありません。そこで、NISTは「CUIを保護するために最低限これだけは実施してほしい」という要件をSP800-53から選び出し、民間企業向けに分かりやすくまとめたのがSP800-171なのです。

---

### 第2章: SP800-171の基本構造

SP800-171は、14の**セキュリティ要件ファミリー**と、それに紐づく110の**セキュリティ要件（管理策）**から構成されています。

#### 2.1 14のセキュリティ要件ファミリー

セキュリティ要件は、関連する内容ごとに14の「ファミリー（分野）」に分類されています。これにより、組織は体系的にセキュリティ対策を検討・実装できます。

| ファミリー番号 | ファミリー名（日本語） | ファミリー名（英語） |
| :--- | :--- | :--- |
| 3.1 | アクセス制御 | Access Control |
| 3.2 | 意識向上と訓練 | Awareness and Training |
| 3.3 | 監査と責任追跡性 | Audit and Accountability |
| 3.4 | 構成管理 | Configuration Management |
| 3.5 | 識別と認証 | Identification and Authentication |
| 3.6 | インシデント対応 | Incident Response |
| 3.7 | 保守 | Maintenance |
| 3.8 | メディア保護 | Media Protection |
| 3.9 | 要員のセキュリティ | Personnel Security |
| 3.10 | 物理的保護 | Physical Protection |
| 3.11 | リスクアセスメント | Risk Assessment |
| 3.12 | セキュリティ評価 | Security Assessment |
| 3.13 | システムと通信の保護 | System and Communications Protection |
| 3.14 | システムと情報のインテグリティ | System and Information Integrity |

#### 2.2 110のセキュリティ要件

110のセキュリティ要件は、さらに2つの種類に分類されます。

*   **基本セキュリティ要件 (Basic Security Requirements):**
    連邦政府の情報処理に関する連邦標準（FIPS）Publication 200で定義されている、情報および情報システムを保護するための17の基本的なセキュリティ要件に由来します。これらは、セキュリティの根幹をなす普遍的な要件です。

*   **派生セキュリティ要件 (Derived Security Requirements):**
    基本要件を補完し、CUIを保護するために必要となる、より具体的で詳細な要件です。これらはSP800-53の管理策から派生しています。

**例:**
ファミリー「3.1 アクセス制御」を見てみましょう。
*   **3.1.1 (基本要件):** 許可されたユーザへのシステムアクセスを制限する。
    *   これは非常に基本的な要件です。
*   **3.1.5 (派生要件):** 未承認の個人がシステムから情報を引き出すのを防ぐ。
    *   これは3.1.1をより具体的にした要件で、例えば画面の覗き見防止や、印刷物の放置禁止といった対策が考えられます。
*   **3.1.7 (派生要件):** 成功しないログオン試行の回数を、定義された期間にわたって制限する。
    *   これはブルートフォース攻撃（総当たり攻撃）を防ぐための、さらに具体的な要件です。

このように、基本要件で大枠を定め、派生要件で具体的な対策を規定する構造になっています。

---

### 第3章: 14のセキュリティ要件ファミリー 詳細解説

ここからは、14のファミリーそれぞれについて、目的と重要な要件、そしてセキュリティエンジニアとしての実践的な実装例を解説します。

#### 3.1 アクセス制御 (Access Control) - 22要件

**目的:** システムや情報へのアクセスを、認可されたユーザーやプロセスのみに制限すること。**「誰が」「何に」「どのように」アクセスできるかを管理**します。

**重要なポイントと実践例:**
*   **最小権限の原則 (Principle of Least Privilege):**
    要件 3.1.1, 3.1.2で求められます。ユーザーには、業務遂行に必要な最低限の権限のみを付与します。
    *   **実践例:**
        *   **Active Directory:** 経理担当者には経理フォルダへの読み書き権限のみを与え、開発部門のフォルダにはアクセスできないようにグループポリシーで設定します。
        *   **Linux:** Webサーバーのプロセスは、`www-data`のような専用の低権限ユーザーで実行し、root権限では実行しません。ファイルのパーミッションを適切に設定します（例: `chmod 644 config.php`）。

*   **アクセスの失敗試行の制限 (Unsuccessful Logon Attempts):**
    要件 3.1.7で求められます。ブルートフォース攻撃を防ぐため、一定回数ログインに失敗したアカウントをロックアウトします。
    *   **実践例:**
        *   **Linux (pam_tally2):** `/etc/pam.d/system-auth` に設定を追加し、「5回連続でログインに失敗したら10分間アカウントをロックする」といったポリシーを適用します。
        *   **Windows:** グループポリシーの「アカウントロックアウトのポリシー」でしきい値や期間を設定します。

*   **リモートアクセスの制御:**
    要件 3.1.12, 3.1.13, 3.1.14で求められます。リモートアクセスは暗号化し、厳格に管理する必要があります。
    *   **実践例:**
        *   **VPN (Virtual Private Network):** OpenVPNやIPsec VPNを構築し、社外からのアクセスは必ずVPNを経由させます。
        *   **ゼロトラストネットワークアクセス (ZTNA):** Zscaler Private Access (ZPA)やCloudflare Accessのような製品を導入し、VPNよりもきめ細かく、ユーザーごと、アプリケーションごとにアクセスを制御します。ZTNAは「決して信頼せず、常に検証する」という**ゼロトラスト**の考え方に基づいています。

#### 3.2 意識向上と訓練 (Awareness and Training) - 3要件

**目的:** 組織の構成員が、自らのセキュリティ上の責任を理解し、脅威を認識できるようにすること。

**重要なポイントと実践例:**
*   **定期的なセキュリティ意識向上活動:**
    要件 3.2.1, 3.2.2で求められます。従業員が直面する可能性のある脅威（例: フィッシング詐欺、マルウェア）について、定期的に情報提供や訓練を行います。
    *   **実践例:**
        *   **標的型攻撃メール訓練:** KnowBe4, PhishMe (Cofense) といったサービスを利用し、擬似的なフィッシングメールを従業員に送信します。メールを開封したり、リンクをクリックしたりした従業員には、その場で追加の教育コンテンツを表示します。
        *   **社内研修:** 年に1回、全従業員を対象とした情報セキュリティ研修会を実施し、最新の脅威動向や社内ルールを周知します。

#### 3.3 監査と責任追跡性 (Audit and Accountability) - 9要件

**目的:** システムで発生したイベントを記録（監査ログ）し、誰が何を行ったかを追跡（責任追跡）できるようにすること。インシデント発生時の原因調査に不可欠です。

**重要なポイントと実践例:**
*   **監査ログの生成と保持:**
    要件 3.3.1, 3.3.2, 3.3.5で求められます。システム上の重要なイベント（ログイン成功/失敗、ファイルアクセス、管理者権限の実行など）を記録し、十分な期間保存します。
    *   **実践例:**
        *   **SIEM (Security Information and Event Management) の導入:** Splunk, Elastic SIEM, Microsoft SentinelといったSIEM製品を導入し、サーバー、ネットワーク機器、アプリケーションなど、さまざまなソースからログを一元的に収集・分析・保管します。
        *   **ログの具体例:**
            *   **Windowsイベントログ:** セキュリティログ（イベントID 4624: ログオン成功, 4625: ログオン失敗）を監視します。
            *   **Apacheアクセスログ:** `192.168.1.10 - - [10/Oct/2023:13:55:36 +0900] "GET /admin/login.php HTTP/1.1" 401 503` のようなログから不正アクセスの試みを検知します。

*   **監査記録の保護:**
    要件 3.3.3で求められます。生成されたログが改ざんされたり、削除されたりしないように保護します。
    *   **実践例:**
        *   ログサーバーへのアクセスを厳しく制限します。
        *   ログを書き込み専用（Write-Once Read-Many, WORM）のストレージに転送します。
        *   ログファイルにハッシュ値を付けて、定期的に完全性を検証します。

#### 3.4 構成管理 (Configuration Management) - 9要件

**目的:** ハードウェア、ソフトウェア、ファームウェアの構成を文書化し、管理し、維持すること。意図しない変更や脆弱な設定を防ぎます。

**重要なポイントと実践例:**
*   **ベースライン構成の確立と強制:**
    要件 3.4.1, 3.4.2で求められます。システムの「あるべき姿（安全な構成）」を**ベースライン**として定義し、その状態を維持します。
    *   **実践例:**
        *   **CISベンチマークの利用:** Center for Internet Security (CIS) が公開しているベンチマークを参考に、OSやミドルウェアのセキュアな設定基準（ベースライン）を作成します。
        *   **構成管理ツールの活用:** Ansible, Puppet, Chefといったツールを使い、サーバー構成をコードとして管理（**Infrastructure as Code, IaC**）します。これにより、全てのサーバーにベースライン構成を自動的かつ強制的に適用できます。
        *   **Ansible Playbookの例 (不要なサービスの停止):**
          ```yaml
          ---
          - hosts: all
            become: true
            tasks:
              - name: Disable and stop telnet service
                service:
                  name: telnet.socket
                  state: stopped
                  enabled: no
          ```

*   **変更管理プロセスの確立:**
    要件 3.4.5で求められます。システムへの変更は、必ず承認プロセスを経て、テストされた上で適用されるようにします。
    *   **実践例:**
        *   JiraやRedmineのようなチケット管理システムを用いて、変更要求、承認、実施、検証のプロセスを記録・管理します。

#### 3.5 識別と認証 (Identification and Authentication) - 11要件

**目的:** システムにアクセスしようとするユーザーやデバイスを「識別」し、その身元が本物であることを「認証」すること。

**重要なポイントと実践例:**
*   **多要素認証 (Multi-Factor Authentication, MFA) の強制:**
    要件 3.5.3で求められます。特にローカルおよびネットワーク経由での特権アクセスや、リモートアクセスにおいてMFAを必須とします。MFAは「知識情報（パスワードなど）」「所持情報（スマートフォン、ハードウェアトークンなど）」「生体情報（指紋、顔など）」のうち、2つ以上を組み合わせて認証する方法です。
    *   **実践例:**
        *   **IDaaS (Identity as a Service) の利用:** Okta, Azure Active Directory, Google WorkspaceなどでMFAを有効化します。
        *   **具体的な認証要素:**
            *   Google AuthenticatorやMicrosoft Authenticatorなどのワンタイムパスワードアプリ。
            *   YubiKeyなどのFIDO2/U2F準拠の物理セキュリティキー。

*   **パスワードポリシーの強化:**
    要件 3.5.7, 3.5.8で求められます。推測されにくい複雑なパスワードを強制し、再利用を禁止します。
    *   **実践例:**
        *   **Windowsグループポリシー:** 「パスワードの長さ」「複雑さの要件」「履歴を記録する」といった設定を強制します。
        *   **パスワード管理ツール:** 1Password, Bitwardenなどの利用を推奨し、ユーザーが複雑なパスワードを安全に管理できるように支援します。

#### 3.6 インシデント対応 (Incident Response) - 8要件

**目的:** セキュリティインシデント（情報漏洩、マルウェア感染など）を検知、分析、封じ込め、根絶し、復旧するための一連の能力を確立すること。

**重要なポイントと実践例:**
*   **インシデント対応計画 (Incident Response Plan, IRP) の策定:**
    要件 3.6.1で求められます。インシデント発生時に「誰が」「何を」「どのように」行うかを定めた計画書を事前に作成し、訓練を通じて習熟しておく必要があります。
    *   **IRPに含めるべき内容:**
        *   報告体制（連絡網）
        *   インシデントのトリアージ（優先順位付け）基準
        *   各役割（リーダー、広報、技術担当など）の責任
        *   対応フェーズ（検知、分析、封じ込め、根絶、復旧、事後活動）ごとの手順

*   **インシデント対応テスト:**
    要件 3.6.2で求められます。机上演習や実践的なシミュレーションを通じて、IRPが実用的であるかを定期的にテストし、改善します。
    *   **実践例:**
        *   「ランサムウェアに感染し、ファイルサーバーが暗号化された」というシナリオで机上演習を実施。各担当者がIRPに従ってどう動くかを確認し、計画の不備や課題を洗い出します。

#### 3.7 保守 (Maintenance) - 6要件

**目的:** システムの保守活動を、セキュリティを確保した状態で行うこと。特に、遠隔での保守（リモートメンテナンス）が攻撃の侵入口とならないように管理します。

**重要なポイントと実践例:**
*   **遠隔保守セッションの管理:**
    要件 3.7.5, 3.7.6で求められます。リモートでの保守作業は、承認された上で、暗号化された経路で行い、MFAを必須とします。
    *   **実践例:**
        *   **踏み台サーバー（Bastion Host / Jump Server）の設置:** 外部から直接本番サーバーにアクセスさせるのではなく、一旦セキュリティを固めた踏み台サーバーにログインさせ、そこから内部のサーバーにアクセスさせます。踏み台サーバーへのアクセスはMFAを必須とし、操作ログを厳格に取得します。
        *   **特権アクセス管理 (Privileged Access Management, PAM) 製品の利用:** CyberArk, BeyondTrustなどのPAM製品を導入し、特権アカウントのパスワード管理、セッションの監視・記録を自動化します。

#### 3.8 メディア保護 (Media Protection) - 9要件

**目的:** USBメモリ、外付けHDD、DVD、紙などの電子/物理メディアに含まれるCUIを保護すること。紛失や盗難による情報漏洩を防ぎます。

**重要なポイントと実践例:**
*   **ポータブルメディアの暗号化:**
    要件 3.8.3で求められます。CUIを保存する可能性のあるデジタルメディアへのアクセスを制限し、可能な限り暗号化します。
    *   **実践例:**
        *   **BitLocker To Go:** Windowsの機能で、USBメモリや外付けHDDを簡単に暗号化できます。パスワードやスマートカードがなければ中身を読み取れません。
        *   **デバイス制御ソフトウェア:** 組織として許可していないUSBデバイスの接続をブロックするソフトウェアを導入します。

*   **メディアの安全な廃棄:**
    要件 3.8.4, 3.8.5で求められます。不要になったメディアは、情報が復元できないように物理的または論理的に破壊します。
    *   **実践例:**
        *   **物理的破壊:** ハードディスクは専用の破砕機（シュレッダー）で粉々にするか、ドリルで穴を開けます。
        *   **論理的破壊:** データ消去ソフトウェア（例: `shred` コマンド in Linux）を使い、ランダムなデータで複数回上書きします。

#### 3.9 要員のセキュリティ (Personnel Security) - 2要件

**目的:** 従業員の入社から退職までの一連のプロセスにおいて、セキュリティリスクを管理すること。

**重要なポイントと実践例:**
*   **入社・異動・退職時の手続き:**
    要件 3.9.2で求められます。従業員が退職または異動する際には、システムへのアクセス権を速やかに無効化し、貸与していたPCやICカードなどを確実に返却させます。
    *   **実践例:**
        *   人事部門とIT部門が連携し、退職者情報が即座に共有される仕組みを構築します。
        *   退職時のチェックリストを作成し、アカウント削除、データ返却、物理キーの回収などが漏れなく行われたことを確認します。

#### 3.10 物理的保護 (Physical Protection) - 6要件

**目的:** システムやCUIが保管されている施設や機器を、不正な物理アクセスから保護すること。

**重要なポイントと実践例:**
*   **物理アクセスの制限と監視:**
    要件 3.10.1, 3.10.4で求められます。サーバー室やCUIを扱うエリアへの立ち入りを、認可された担当者のみに制限します。
    *   **実践例:**
        *   **入退室管理システム:** ICカードや生体認証（指紋、静脈）による入退室管理システムを導入し、誰がいつ入退室したかのログを記録します。
        *   **監視カメラ:** 重要なエリアに監視カメラを設置し、不正侵入を抑止・検知します。
        *   **ビジター管理:** 来訪者には受付で身分証明書の提示を求め、一時的なアクセスカードを発行します。訪問中は必ず従業員が付き添うルールを徹底します。

#### 3.11 リスクアセスメント (Risk Assessment) - 3要件

**目的:** 組織の運用、資産、個人に対するセキュリティリスクを定期的に評価し、許容可能なレベルに管理すること。

**重要なポイントと実践例:**
*   **脆弱性スキャンの定期的な実施:**
    要件 3.11.2で求められます。システムに潜むセキュリティ上の弱点（脆弱性）を定期的にスキャンし、発見します。
    *   **実践例:**
        *   **脆弱性スキャンツールの利用:** Nessus, OpenVAS, Qualysなどのツールを使い、ネットワーク上のサーバーやPCに対して定期的にスキャンを実行します。
        *   **発見された脆弱性の管理:** スキャン結果を分析し、脆弱性の深刻度（CVSSスコアなど）に基づいて優先順位を付け、修正計画を立てて対応します。

#### 3.12 セキュリティ評価 (Security Assessment) - 4要件

**目的:** 導入したセキュリティ対策が、意図通りに効果的に機能しているかを定期的に評価・監視すること。

**重要なポイントと実践例:**
*   **システムセキュリティ計画書 (SSP) の策定と維持:**
    要件 3.12.4で求められます。組織がSP800-171の各要件を**どのように満たしているか**を記述した文書（SSP）を作成し、最新の状態に保ちます。
    *   **SSPに記述する内容:**
        *   システムの境界（どこまでが対象か）
        *   110の各要件に対する実装状況（実装済み、未実装、適用除外など）
        *   具体的な実装方法（例: 要件3.5.3 MFAの実装にはAzure ADの条件付きアクセスを使用）

*   **行動計画とマイルストーン (POA&M) の作成:**
    要件 3.12.2で求められます。セキュリティ評価の結果、要件を満たせていない項目（ギャップ）が見つかった場合、それを**いつまでに、どのように改善するか**を具体的に記述した計画書（POA&M）を作成し、進捗を管理します。

#### 3.13 システムと通信の保護 (System and Communications Protection) - 22要件

**目的:** 組織の内部および外部の境界で、システムと通信の経路を監視・制御・保護すること。ネットワークセキュリティの中核をなすファミリーです。

**重要なポイントと実践例:**
*   **境界防御 (Boundary Protection):**
    要件 3.13.1, 3.13.6で求められます。インターネットとの境界にファイアウォールなどを設置し、不正な通信をブロックします。
    *   **実践例:**
        *   **ファイアウォール:** Palo Alto Networks, Fortinetなどの次世代ファイアウォール（NGFW）を導入し、アプリケーションレベルでの通信制御や不正侵入防御システム（IPS）機能を利用します。
        *   **Linux (iptables/nftables):** サーバー自身でファイアウォールを設定し、不要なポートへのアクセスをブロックします。
          ```bash
          # SSH(22), HTTP(80), HTTPS(443) のみ許可し、他は拒否する例
          iptables -P INPUT DROP
          iptables -A INPUT -i lo -j ACCEPT
          iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
          iptables -A INPUT -p tcp --dport 22 -j ACCEPT
          iptables -A INPUT -p tcp --dport 80 -j ACCEPT
          iptables -A INPUT -p tcp --dport 443 -j ACCEPT
          ```

*   **通信の暗号化:**
    要件 3.13.8, 3.13.16で求められます。CUIを含む通信は、盗聴されても内容が分からないように暗号化します。
    *   **実践例:**
        *   **TLS/SSL:** WebサイトやAPI通信では、HTTPS（TLS）を強制します。
        *   **VPN:** リモートアクセスや拠点間通信では、IPsec VPNやSSL-VPNを利用します。
        *   **FIPS 140-2準拠の暗号モジュール:** 政府機関との要件で求められる場合、FIPS 140-2という連邦標準に準拠した暗号モジュール（ハードウェアまたはソフトウェア）を使用します。

*   **ネットワークの分離 (セグメンテーション):**
    CUIを扱うシステムを、一般の業務用ネットワークから分離します。これにより、万が一マルウェアに感染しても、被害がCUIシステムに及ぶのを防ぎます。

#### 3.14 システムと情報のインテグリティ (System and Information Integrity) - 7要件

**目的:** システムや情報が、不正に改ざんされることを防ぎ、検知し、修正すること。インテグリティは「完全性」と訳されます。

**重要なポイントと実践例:**
*   **マルウェア対策:**
    要件 3.14.2, 3.14.4, 3.14.5で求められます。ウイルス、ワーム、トロイの木馬などの悪意のあるコードからシステムを保護します。
    *   **実践例:**
        *   **次世代アンチウイルス (NGAV) / EDR (Endpoint Detection and Response) の導入:** CrowdStrike, SentinelOne, Microsoft Defender for Endpointなどの製品を導入します。これらは従来のパターンマッチングだけでなく、振る舞い検知やAIを用いて未知のマルウェアも検知・防御できます。
        *   **定期的なスキャンと定義ファイルの自動更新**を徹底します。

*   **不正な変更の検知:**
    要件 3.14.7で求められます。重要なシステムファイルや設定ファイルが変更された場合に、それを検知して管理者に通知します。
    *   **実践例:**
        *   **ファイル改ざん検知 (FIM) ツールの利用:** Tripwire, AIDE (Advanced Intrusion Detection Environment) などのツールを導入します。これらのツールは、正常な状態のファイルハッシュ値をベースラインとして保存し、定期的に現在のハッシュ値と比較することで、変更を検知します。

---

### 第4章: NIST SP800-171への準拠プロセス

SP800-171の要件を理解したところで、次に組織としてどのように準拠していくかのプロセスを解説します。

#### Step 1: スコープの定義

*   **目的:** 準拠の対象となる範囲を明確にします。
*   **内容:**
    1.  **CUIの特定:** 組織内で取り扱っているCUIが何か、どの文書やデータに含まれるかを洗い出します。契約書や仕様書を確認します。
    2.  **CUIの保管・処理場所の特定:** 特定したCUIが、どのサーバー、PC、ネットワーク、クラウドサービス上に存在し、処理されているかをマッピングします。
    3.  **システムの境界設定:** CUIを保護すべき情報システムの範囲（スコープ）を定義します。スコープを限定することで、対策のコストと労力を集中させることができます。

#### Step 2: 現状評価 (ギャップ分析)

*   **目的:** 110のセキュリティ要件に対して、自社の現状がどの程度満たされているかを評価し、不足している点（ギャップ）を洗い出します。
*   **内容:**
    *   110の各要件について、「Implemented（実装済み）」「Partially Implemented（部分的に実装）」「Not Implemented（未実装）」「Not Applicable（適用外）」などを評価します。
    *   評価の根拠となる文書（ポリシー、手順書など）や設定画面のスクリーンショットなどをエビデンスとして収集します。

#### Step 3: システムセキュリティ計画書 (SSP) の作成

*   **目的:** ギャップ分析の結果を踏まえ、110の各要件を「どのように満たしているか」または「今後どのように満たす計画か」を文書化します。
*   **内容:** SSPは、自社のCUI保護への取り組みを示す中心的な文書となります。
    *   システムの概要、境界、ネットワーク図などを記述します。
    *   110の要件ごとに、実装状況と具体的な実装方法を記述します。
    *   **例:**「要件3.5.3 (MFA) は、Microsoft Azure ADの条件付きアクセスポリシーを用いて実装しており、全ての特権ユーザーとリモートアクセスユーザーに適用している」といった具体的な記述をします。

#### Step 4: 行動計画とマイルストーン (POA&M) の作成

*   **目的:** ギャップ分析で明らかになった「未実装」または「部分的に実装」の項目を、いつまでに、どのように改善するかの具体的な計画を立てます。
*   **内容:** POA&Mは、改善活動のプロジェクト管理ツールとなります。
    *   各ギャップ項目に対して、具体的な対策、担当部署/担当者、完了予定日（マイルストーン）、必要なリソースなどを記述します。
    *   **例:**「要件3.11.2 (脆弱性スキャン) - 対策: Nessus Professionalを導入し、月次で全サーバーのスキャンを実施する。 - 担当: ITインフラ部 - 完了予定日: 2024年12月31日」

#### Step 5: 改善策の実施

*   **目的:** POA&Mに基づいて、セキュリティ対策を着実に実施します。
*   **内容:**
    *   新しいツールの導入、ポリシーの策定・改訂、従業員へのトレーニングなど、計画に沿って改善活動を進めます。
    *   進捗状況は定期的にレビューし、必要に応じてPOA&Mを更新します。

#### Step 6: 評価と維持

*   **目的:** 一度準拠して終わりではなく、セキュリティ対策が継続的に有効であることを確認し、維持・向上させます。
*   **内容:**
    *   定期的な自己評価や内部監査を実施します。
    *   脆弱性スキャンやペネトレーションテストを定期的に行います。
    *   システム構成やビジネス環境の変化に合わせて、SSPとPOA&Mを常に見直し、最新の状態に保ちます。

---

### 第5章: CMMCとの関連性と今後の動向

NIST SP800-171を語る上で、**CMMC (Cybersecurity Maturity Model Certification / サイバーセキュリティ成熟度モデル認証)** との関係は避けて通れません。

#### 5.1 CMMCとは？

CMMCは、米国国防総省（DoD）のサプライチェーンに参加する企業に求められるサイバーセキュリティ基準の認証制度です。

*   **背景:** SP800-171は、企業による「自己評価」に基づいていました。しかし、自己評価だけでは信頼性に欠け、実際に準拠していない企業も多いという問題がありました。
*   **目的:** そこでDoDは、より信頼性の高い「**第三者機関による評価・認証**」を義務付けるCMMCを導入しました。

#### 5.2 SP800-171とCMMCの関係

CMMCは複数のレベルに分かれていますが、その中心となる**CMMC Level 2 (Advanced) は、NIST SP800-171の110要件に完全に基づいています**。

*   **SP800-171準拠 → CMMC Level 2の基礎**
    つまり、DoDと取引する企業は、SP800-171の要件を実装した上で、第三者評価機関（C3PAO）による審査を受け、CMMC Level 2の認証を取得する必要が出てきます。（契約内容によっては自己評価が認められる場合もあります）

#### 5.3 日本企業への影響

米国防総省のサプライチェーンはグローバルに広がっており、日本の防衛関連企業や部品メーカーなども含まれます。これらの企業は、米国企業の下請けとして取引する場合でも、契約の中でCMMC認証を求められる可能性が高まっています。

SP800-171への対応は、もはや米国だけの話ではなく、グローバルなサプライチェーンに参加するための必須要件になりつつあります。

---

### 第6章: まとめ

NIST SP800-171は、米国政府のサプライチェーンにおけるCUI保護を目的とした、包括的かつ実践的なセキュリティガイドラインです。

*   **中心的な概念:** **CUI（管理対象非機密情報）**を、それを扱う民間企業のシステム内で保護すること。
*   **構造:** 14のファミリーと110の要件からなり、アクセス制御から物理的保護まで、セキュリティの幅広い領域をカバーしています。
*   **実装:** 単にツールを導入するだけでなく、**SSP**や**POA&M**といった文書を作成し、計画的かつ継続的にセキュリティを管理・改善するプロセスが求められます。
*   **将来性:** **CMMC**の基礎となっており、その重要性は今後ますます高まっていきます。

