### サイバーキルチェーンとは

サイバーキルチェーンとは、サイバー攻撃、特に「標的型攻撃」と呼ばれる特定の組織を狙った攻撃が、どのような手順で進行するかを分析し、段階分けしたモデルです。 もともとは軍事用語であった「キルチェーン」という、敵の攻撃構造を破壊して自軍を防御する考え方を、サイバーセキュリティに応用したものです。

提唱したのは、米国の航空宇宙・防衛大手であるロッキード・マーティン社で、2011年に発表されました。 このモデルの目的は、攻撃者の行動を「偵察」から「目的の実行」までの一連の連鎖（チェーン）として捉え、その鎖のどこか一か所でも断ち切ることで、攻撃全体の成功を防ぎ、被害を最小限に抑えることにあります。

攻撃の全体像を可視化することで、各段階でどのような対策を講じるべきかが明確になり、効果的な防御戦略を立てることが可能になります。

---

### サイバーキルチェーンの7つの段階と具体例

サイバーキルチェーンは、攻撃者の行動を以下の7つの段階に分類しています。 ここでは、各段階の目的、具体的な手法、そして実践的な攻撃シナリオの例を解説します。

#### 1. 偵察 (Reconnaissance)

**目的:** 攻撃対象となる組織や個人を調査し、攻撃の足掛かりとなる情報を収集します。

**具体的な手法:**
*   **OSINT (Open Source Intelligence):** 企業のウェブサイト、プレスリリース、SNS、求人情報など、一般に公開されている情報から、組織構造、従業員の氏名や役職、メールアドレス、使用している技術などを収集します。
*   **技術的な調査:** `whois`コマンドでドメインの登録情報を確認したり、`Nmap`のようなポートスキャンツールで稼働中のサーバーや開いているポートを特定したりします。
*   **ソーシャルエンジニアリング:** 従業員になりすまして電話をかけ、情報を聞き出すなどの手法も含まれます。

**実践的な例:**
攻撃者は、標的企業のウェブサイトからIR情報や役員一覧を調べ、経理部門の従業員の氏名を特定します。さらに、SNSを調査してその従業員の趣味や交友関係を把握し、後のフィッシングメールに利用するための情報を集めます。

#### 2. 武器化 (Weaponization)

**目的:** 偵察で得た情報を基に、標的の脆弱性を突くための攻撃ツール（マルウェアなど）を作成・準備します。

**具体的な手法:**
*   **マルウェアの作成:** 標的の環境（OSや利用ソフトウェア）に合わせて、ウイルスやトロイの木馬、ランサムウェアなどを作成します。
*   **エクスプロイトキットの利用:** 既知の脆弱性を悪用する攻撃コードを組み合わせたツールキットを利用します。
*   **文書ファイルへの埋め込み:** Microsoft Office文書（WordやExcel）のマクロ機能や、PDFファイルの脆弱性を悪用し、ファイルを開くとマルウェアが実行されるように細工します。

**実践的な例:**
攻撃者は、偵察で特定した経理担当者が利用している会計ソフトの脆弱性を突くマルウェアを作成します。そして、「請求書」というファイル名のWord文書にそのマルウェアを埋め込み、アイコンも偽装して、一見するとただの文書ファイルに見えるようにします。

#### 3. 配送 (Delivery)

**目的:** 武器化したマルウェアを、何らかの手段で標的の環境へ送り込みます。

**具体的な手法:**
*   **標的型メール（スピアフィッシング）:** 最も一般的な手法です。特定の個人や組織に合わせて巧妙に作りこんだメールを送り、添付ファイルを開かせたり、悪意のあるWebサイトへのリンクをクリックさせたりします。
*   **水飲み場攻撃 (Watering Hole Attack):** 標的が頻繁に訪れるWebサイトを改ざんし、アクセスしただけでマルウェアに感染するように仕掛けます。
*   **物理メディア:** USBメモリなどの物理メディアにマルウェアを仕込み、標的の組織内に持ち込ませます。

**実践的な例:**
攻撃者は、取引先を装って、武器化した「請求書.doc」ファイルを添付したメールを経理担当者に送信します。メールの本文には、「お世話になっております。先月の請求書をお送りいたしますので、ご確認のほどよろしくお願いいたします。」といった、業務上ごく自然な内容を記述します。

#### 4. 攻撃 (Exploitation)

**目的:** 配送したマルウェアを標的のシステム上で実行させ、脆弱性を悪用して侵入を成功させます。 「エクスプロイト」とも呼ばれます。

**具体的な手法:**
*   **脆弱性の悪用:** OS、ブラウザ、アプリケーション（Adobe Flash PlayerやJavaなど）の脆弱性を利用して、不正なコードを実行させます。
*   **ユーザーの操作:** ユーザーに添付ファイルを開かせたり、「コンテンツの有効化」をクリックさせたりすることで、マルウェアを実行させます。

**実践的な例:**
メールを受け取った経理担当者が、添付されていた「請求書.doc」ファイルを開きます。Wordの上部に「保護ビュー」の警告が表示され、「編集を有効にする」ボタンをクリックすると、埋め込まれていたマクロが実行されます。このマクロが、PC内の脆弱性を悪用して、本体のマルウェアをダウンロードし、実行します。

#### 5. インストール (Installation)

**目的:** 侵入に成功したシステムにマルウェアを常駐させ、持続的なアクセスを確保（永続化）します。

**具体的な手法:**
*   **バックドアの設置:** 攻撃者がいつでも外部から侵入できるように、裏口となるプログラムを設置します。
*   **永続化:** PCの起動時にマルウェアが自動的に実行されるよう、レジストリやスタートアップフォルダに登録します。
*   **正規プロセスへの偽装:** マルウェアがシステムの正規プロセス（svchost.exeなど）に見せかけて活動し、検知を逃れようとします。

**実践的な例:**
実行されたマルウェアは、まず自身のコピーをシステムの奥深くに作成します。次に、Windowsのレジストリを書き換え、PCが起動するたびに自身が自動実行されるように設定します。これにより、PCを再起動してもマルウェアは活動を続けることができます。

#### 6. 遠隔操作 (Command and Control / C2)

**目的:** 攻撃者が外部からマルウェアに感染したシステムを自由に操るための通信路（C2チャネル）を確立します。

**具体的な手法:**
*   **C2サーバーとの通信:** 攻撃者が用意した指令サーバー（C2サーバー）と定期的に通信を行います。
*   **通信の偽装:** 通信が怪しまれないように、一般的なWebトラフィック（HTTP/HTTPS）やDNSクエリに偽装することが多いです。
*   **プロキシ経由の通信:** 複数のサーバーを経由して通信経路を複雑にし、発信源の特定を困難にします。

**実践的な例:**
マルウェアは、外部にある攻撃者のC2サーバーに対して、数分おきにHTTPS通信を試みます。この通信は、一見すると通常のWebサイトへのアクセスと区別がつきません。通信が確立されると、マルウェアはC2サーバーからの次の命令を待ち受けます。

#### 7. 目的の実行 (Actions on Objectives)

**目的:** 攻撃者が当初の目的を達成するための最終的な行動を実行します。

**具体的な手法:**
*   **データの窃取:** 機密情報や個人情報、知的財産などを探し出し、圧縮・暗号化してC2サーバー経由で外部に送信（流出）します。
*   **ラテラルムーブメント (横展開):** 侵入したPCを踏み台にして、ネットワーク内の他のサーバーやPCへと感染を拡大し、より重要な情報（管理者権限など）を探します。
*   **データの破壊・改ざん:** システム上の重要なデータを破壊したり、ウェブサイトを改ざんしたりします。
*   **ランサムウェアによる暗号化:** ファイルを暗号化して身代金を要求します。

**実践的な例:**
C2サーバーからの指令を受け、マルウェアはファイルサーバーにアクセスし、顧客情報や財務データなどの機密情報を探索します。見つけたデータを暗号化してZIPファイルにまとめ、深夜などネットワークトラフィックが少ない時間帯を狙って、C2サーバーへ少しずつ分割して送信します。攻撃が完了すると、自身の活動ログを消去して痕跡を隠蔽します。

---

### 各段階における具体的な対処手順

サイバーキルチェーンの各段階を理解することで、防御側は攻撃の連鎖を断ち切るための具体的な対策を講じることができます。これは「多層防御（Defense in Depth）」の考え方にも繋がります。

| 段階 | 防御側の対処手順 |
| :--- | :--- |
| **1. 偵察** | **公開情報の管理:** Webサイトなどで公開している情報を精査し、不要な技術情報や個人情報は削除します。<br>**監視:** ファイアウォールや侵入検知システム（IDS）で、不審なスキャン行為や大量のアクセスがないか監視します。<br>**従業員教育:** SNSなどで業務に関する情報を安易に公開しないよう、従業員への注意喚起を行います。 |
| **2. 武器化** | **脅威インテリジェンスの活用:** 攻撃者がどのようなマルウェアや脆弱性を利用しているか、最新の脅威情報を収集・分析し、自社の防御策に活かします。これは攻撃者側の段階のため、直接的な防御は困難です。 |
| **3. 配送** | **メールセキュリティ:** 迷惑メールフィルタやサンドボックス機能付きのメールセキュリティゲートウェイを導入し、不正な添付ファイルやURLをブロックします。<br>**Webフィルタリング:** 業務に関係のないサイトや、危険性が確認されているサイトへのアクセスをブロックします。<br>**従業員教育:** 不審なメールや添付ファイルを安易に開かない、URLをクリックしないといった基本的なセキュリティ意識を徹底させるための標的型メール訓練などを定期的に実施します。 |
| **4. 攻撃** | **脆弱性管理:** OSやソフトウェアを常に最新の状態に保ち、セキュリティパッチを速やかに適用します。<br>**アンチウイルス/EPP:** シグネチャ型・振る舞い検知型のアンチウイルスソフト（EPP: Endpoint Protection Platform）を導入し、既知・未知のマルウェア実行を防ぎます。<br>**攻撃対象領域の縮小:** 不要なサービスやポートを無効化し、攻撃者に悪用される可能性のある箇所を減らします。 |
| **5. インストール** | **EDR (Endpoint Detection and Response)の導入:** PCやサーバー（エンドポイント）の動作を常時監視し、不審なプロセスの生成、レジストリの書き換え、不正なファイルの作成といったマルウェアのインストール活動を検知・阻止します。<br>**権限管理:** 従業員には業務に必要な最小限の権限のみを与え（最小権限の原則）、管理者権限の利用を厳しく制限します。 |
| **6. 遠隔操作** | **出口対策の強化:** 次世代ファイアウォール（NGFW）やプロキシサーバーで、外部の不審なC2サーバーへの通信を監視・ブロックします。 特に、未知の宛先への通信や、通常業務では利用しないポートでの通信を厳しく制限します。<br>**SIEM (Security Information and Event Management)の活用:** 様々な機器のログを一元的に収集・分析し、C2通信の兆候（例：定期的な不審な通信）を検知します。<br>**DNS監視:** DNSクエリのログを監視し、マルウェアが利用するドメインへの名前解決要求をブロックします（DNSシンクホール）。 |
| **7. 目的の実行** | **内部ネットワークの監視:** EDRやNDR (Network Detection and Response) を利用して、ネットワーク内部での不審な挙動（ラテラルムーブメント）を検知します。<br>**データ損失防止 (DLP):** 機密情報にタグ付けを行い、社外への不正な持ち出しや送信を監視・ブロックします。<br>**アクセス制御:** ファイルサーバーなど重要な情報資産へのアクセス権を厳格に管理し、不正なアクセスを防止します。<br>**バックアップ:** 定期的にデータのバックアップを取得し、ランサムウェア被害などに備えて、迅速に復旧できる体制を整えます。 |

---

### サイバーキルチェーンの限界と近年の傾向

サイバーキルチェーンは攻撃を理解する上で非常に有効なフレームワークですが、万能ではありません。近年の攻撃の進化に伴い、その限界も指摘されています。

#### サイバーキルチェーンの限界

*   **対象範囲の限定:** 主に外部からの侵入を前提とした標的型攻撃をモデルにしており、内部不正やDDoS攻撃、Webアプリケーションへの単発の攻撃など、すべての攻撃 유형を網羅しているわけではありません。
*   **直線的なプロセス:** 実際の攻撃は必ずしも7つの段階を順番通りに進むとは限りません。 複数の段階が同時に進行したり、途中の段階を飛ばしたりすることもあります。
*   **内部への視点の欠如:** 一度侵入された後の内部での活動（ラテラルムーブメントなど）の描写が「目的の実行」に集約されており、詳細な分析には不十分な場合があります。

#### 近年の傾向と新しい考え方

##### 1. Living off the Land (LotL) 攻撃の台頭
「環境寄生型攻撃」とも呼ばれ、攻撃者がマルウェアなどの新たなツールを持ち込むのではなく、OSに標準搭載されている正規のツール（PowerShell, WMIなど）を悪用する攻撃手法です。 正規のツールを悪用するため、従来のアンチウイルスソフトでは検知が極めて困難であり、EDRなどによる挙動監視の重要性が高まっています。

**具体例:**
攻撃者はPowerShellスクリプトを実行し、ネットワーク内の情報を収集したり、他のPCへ不正なコマンドを送信したりします。これらの活動は、システム管理者の正規の操作と見分けるのが難しい場合があります。

##### 2. ランサムウェア攻撃の高度化
従来のデータを暗号化して身代金を要求する手口に加え、事前にデータを窃取しておき、「身代金を支払わなければデータを公開する」と脅す「二重脅迫」が主流になっています。さらに、DDoS攻撃を仕掛けたり、被害企業の顧客に連絡したりする「三重脅迫」「四重脅迫」へとエスカレートしています。

##### 3. サプライチェーン攻撃
セキュリティ対策が強固な大企業を直接狙うのではなく、取引先やソフトウェア開発元など、比較的セキュリティが手薄な関連企業を踏み台にして侵入する攻撃です。信頼されたルートからの侵入となるため、防御が困難です。

##### 4. MITRE ATT&CKフレームワークとの連携
サイバーキルチェーンが攻撃の「段階（なぜ）」を示すのに対し、**MITRE ATT&CK**は、各段階で攻撃者が具体的にどのような「戦術（なにを）」と「技術（どのように）」を使用するかを網羅的にまとめた知識ベースです。 ATT&CKはサイバーキルチェーンよりも詳細で、特に侵入後の内部活動の分析に優れています。
現代のセキュリティ運用では、サイバーキルチェーンで攻撃の全体像を捉え、ATT&CKで個々の攻撃手法の詳細な分析と対策を行う、というように両者を組み合わせて活用することが一般的です。

##### 5. 統合サイバーキルチェーン (Unified Cyber Kill Chain)
従来のサイバーキルチェーンに、内部不正や偵察段階の追加など、より広範な脅威シナリオを組み込み、18のフェーズに拡張したモデルです。現代の多様な攻撃手法に対応するために提唱されています。

##### 6. ゼロトラストアーキテクチャへの移行
「社内は安全、社外は危険」という従来の境界型防御モデルが、クラウド利用やテレワークの普及により崩壊しつつあります。 これに対し、「誰も信頼しない（Never Trust, Always Verify）」を前提とし、社内外問わずすべてのアクセス要求を検証・認証する「**ゼロトラスト**」という考え方が主流になっています。 ゼロトラストは、たとえ侵入を許したとしても、攻撃者が内部で自由に活動（ラテラルムーブメント）することを困難にし、被害を最小化する上で効果的です。

---

### 実践的な防御と関連する製品・ソリューション

サイバーキルチェーンの各段階で攻撃を阻止するには、単一の製品に頼るのではなく、複数のセキュリティソリューションを組み合わせた「多層防御」が不可欠です。以下に、各対策で利用される代表的な製品カテゴリーと具体的な製品名を挙げます。

*   **次世代ファイアウォール (NGFW) / UTM (統合脅威管理)**
    *   **役割:** ネットワークの入口・出口対策の要。アプリケーションレベルでの通信制御や、不正侵入防止システム（IPS）機能を提供します。
    *   **代表的な製品:** Palo Alto Networks PA-Series, Fortinet FortiGate, Check Point Quantum

*   **メールセキュリティゲートウェイ**
    *   **役割:** 「配送」段階での脅威をブロック。スパム、フィッシングメール、マルウェア付き添付ファイルを検知・隔離します。
    *   **代表的な製品:** Proofpoint, Mimecast, Cisco Secure Email

*   **エンドポイントセキュリティ (EPP / EDR)**
    *   **役割:** PCやサーバーを保護する最後の砦。「攻撃」「インストール」以降の段階でマルウェアの実行を阻止し、侵入後の不審な挙動を検知・対応します。
    *   **代表的な製品:** CrowdStrike Falcon, SentinelOne Singularity, Cybereason, Microsoft Defender for Endpoint

*   **SIEM (Security Information and Event Management)**
    *   **役割:** 組織内の様々なIT機器からログを収集・相関分析し、脅威を可視化します。 キルチェーンの複数の段階にまたがる攻撃の兆候を捉えるのに有効です。
    *   **代表的な製品:** Splunk, IBM QRadar, Microsoft Sentinel, Exabeam

*   **脆弱性管理ツール**
    *   **役割:** 「攻撃」段階で悪用される脆弱性を事前に発見・管理します。システムのスキャンを行い、パッチが適用されていない脆弱性を特定します。
    *   **代表的な製品:** Tenable Nessus, Qualys, Rapid7 InsightVM

