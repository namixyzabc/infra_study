
### セキュリティ項目チェックリスト**

このチェックリストは、インフラエンジニアが考慮すべきセキュリティ項目を網羅的にまとめたものです。ネットワーク、サーバー、クラウドといった技術領域に加え、運用プロセスやインシデント対応までをカバーしています。CIS ControlsやNIST SP 800-53などのフレームワークを参考にし、オンプレミス、クラウド、ハイブリッドなど、あらゆる環境で活用できるよう設計されています。

実際の適用にあたっては、組織の規模、システム要件、コンプライアンスに応じて項目をカスタマイズしてください。

---

### **1. ネットワークセキュリティ**
ネットワークの境界防御、内部のトラフィック制御、通信の暗号化を徹底します。

**ファイアウォールと境界防御**
- [ ] **デフォルト拒否ポリシー:** 許可する通信（例: TCP/80, 443）以外はすべて拒否する設定を適用する。
- [ ] **ステートフルインスペクション:** 通信のコンテキストを追跡し、正当な応答のみを許可する。
- [ ] **アウトバウンド通信制限:** 外部への不要な通信を制限し、情報漏洩やC&Cサーバーとの通信を防止する。
- [ ] **WAF (Web Application Firewall) の導入:** SQLインジェクションやクロスサイトスクリプティング（XSS）などのWebアプリケーション攻撃を防御する。
- [ ] **DDoS対策:** CDN（例: Cloudflare, Akamai）の活用や、Rate Limitingを設定する。
- [ ] **ルーター/スイッチの強化:** 未使用ポートのシャットダウン、SNMPv3による暗号化通信、BGPルーティングのフィルタリング（RPKI）を適用する。

**ネットワークセグメンテーション**
- [ ] **VLAN/サブネット分割:** DMZ、本番環境、開発環境、管理ネットワークなどを論理的に分離する（802.1Q）。
- [ ] **マイクロセグメンテーション:** Zero Trustモデルに基づき、サーバーやコンテナ間の東西（East-West）トラフィックを厳格に制御する（例: VMware NSX, Calico）。
- [ ] **ネットワークACL:** サブネットレベルでのステートレスなトラフィックフィルタリングを設定する。

**通信の暗号化と監視**
- [ ] **VPNの導入:** リモートアクセスや拠点間通信をIPsecやWireGuardで暗号化し、MFAを必須とする。
- [ ] **IDS/IPS (侵入検知/防止システム):** 異常なトラフィックを検知・ブロックする（例: Snort, Suricata）。シグネチャベースと異常検知ベースの両方を活用する。
- [ ] **DNSセキュリティ:** DNSSECを有効化してDNSキャッシュポイズニングを防止し、DoH/DoTでDNSクエリを暗号化する。
- [ ] **Wi-Fiセキュリティ:** WPA3とEAP-TLS認証を適用し、ゲストネットワークを内部ネットワークから完全に分離する。
- [ ] **IPv6セキュリティ:** 不要な場合は無効化、またはACLでICMPv6などを適切にフィルタリングする。

---

### **2. サーバー・ホストセキュリティ**
OS、仮想化基盤、コンテナの堅牢化（ハードニング）と保護を行います。

**OSハードニング**
- [ ] **CISベンチマーク準拠:** CISベンチマークに基づき、不要なサービス（例: telnet）の停止やカーネルパラメータの最適化を行う。
- [ ] **MAC (Mandatory Access Control):** SELinuxやAppArmorをenforcingモードで運用し、プロセスの動作を強制的に制限する。
- [ ] **ファイルシステムセキュリティ:** `chmod`でディレクトリやファイルの権限を厳格化し、`dm-crypt/LUKS`や`BitLocker`でディスク全体を暗号化する。
- [ ] **ブートセキュリティ:** Secure Bootを有効化し、UEFI/BIOSファームウェアを最新に保ち、GRUBにパスワードを設定する。

**アクセス制御と監視**
- [ ] **SSH設定の強化:** パスワード認証を禁止し、公開鍵認証のみを許可する。非標準ポートの使用、接続元IP制限、Protocol 2のみの使用を徹底する。
- [ ] **sudo権限の最小化:** `/etc/sudoers`でコマンド実行権限を必要最小限に設定し、rootでの直接ログインを禁止する。
- [ ] **ログイン監視と防御:** `Fail2Ban`や`OSSEC`でブルートフォース攻撃を自動的にブロックし、PAM（Pluggable Authentication Modules）で認証プロセスを強化する。
- [ ] **マルウェア対策:** EDR（Endpoint Detection and Response）ツール（例: CrowdStrike）やウイルス対策ソフト（例: ClamAV）でリアルタイムスキャンと脅威からの隔離を行う。

**仮想化・コンテナセキュリティ**
- [ ] **ハイパーバイザーの保護:** ESXiやKVMなどのハイパーバイザーに定期的にパッチを適用し、VM間の通信をvSwitchなどで適切に分離する。
- [ ] **コンテナイメージの保護:** 非rootユーザーでの実行を強制し、`Trivy`や`Clair`でイメージの脆弱性をスキャンする。イメージ署名（例: Notary）を検証する。
- [ ] **コンテナランタイム保護:** Pod Security Policies (PSP) やPod Security Admission (PSA) を適用し、リソース制限（cgroups）やプロセス隔離（namespaces）を行う。

---

### **3. クラウドセキュリティ (IaaS/PaaS)**
AWS, Azure, GCPなどのクラウド環境に特化したセキュリティ対策を実施します。

**IDとアクセスの管理 (IAM)**
- [ ] **最小権限の原則:** IAMユーザーやロールにアタッチするポリシーを、職務に必要な最小限の権限に限定する。
- [ ] **MFAの強制:** すべてのユーザー、特に管理者権限を持つアカウントに対してMFAを必須とする。
- [ ] **ロールベースのアクセス:** ユーザーに直接ポリシーをアタッチするのではなく、IAMロール（AWS）やマネージドID（Azure）を利用して一時的な認証情報を払い出す。

**ネットワークとストレージの保護**
- [ ] **仮想ネットワーク制御:** VPC/VNetのセキュリティグループ（ステートフル）とネットワークACL（ステートレス）でインスタンスへのトラフィックを厳密に制御する。
- [ ] **プライベート接続:** Private LinkやVPCエンドポイントを利用して、パブリックインターネットを経由しないセキュアなサービス間通信を実現する。
- [ ] **ストレージセキュリティ:** S3バケットなどのオブジェクトストレージのパブリックアクセスを原則禁止し、サーバーサイド暗号化（SSE-KMSなど）を有効にする。

**脅威検知とコンプライアンス**
- [ ] **脅威検知サービスの活用:** GuardDuty (AWS), Azure Defender (Azure), Security Command Center (GCP) を有効化し、異常なアクティビティを自動で検知する。
- [ ] **設定監査の自動化:** AWS Config, Azure Policy, Google Cloud Asset Inventoryを利用して、セキュリティポリシーに準拠しないリソース設定を自動的に検知・修正する。
- [ ] **APIログの収集:** CloudTrail (AWS) やActivity Log (Azure) を有効にし、すべてのAPIコールを記録・監視する。

---

### **4. データ保護と暗号化**
データのライフサイクル全体を通じて、機密性、完全性、可用性を確保します。

**データの暗号化**
- [ ] **保存データの暗号化 (At Rest):** データベース（TDE）、ストレージ（LUKS, BitLocker）、バックアップデータなどをAES-256で暗号化する。
- [ ] **転送データの暗号化 (In Transit):** 通信はすべてTLS 1.2以上（TLS 1.3推奨）で暗号化する。
- [ ] **暗号鍵管理:** HSM (Hardware Security Module) やKMS (Key Management Service) を利用して、暗号鍵をセキュアに管理・ローテーションする。

**バックアップと災害復旧**
- [ ] **バックアップ戦略 (3-2-1ルール):** 3つのコピーを、2種類の異なるメディアに、そのうち1つはオフサイト（またはイミュータブルストレージ）に保管する。
- [ ] **バックアップデータの保護:** バックアップデータを暗号化し、アクセス制御を厳格に行う。定期的にリストアテストを実施し、完全性を検証する。
- [ ] **災害復旧 (DR) 計画:** RTO（目標復旧時間）とRPO（目標復旧時点）を定義し、DRサイトへのフェイルオーバーテストを定期的に実施する。

**データの整合性と漏洩防止**
- [ ] **ファイル整合性監視 (FIM):** `Tripwire`や`AIDE`などのツールで、重要な設定ファイルやバイナリの改ざんを検知する。
- [ ] **データ漏洩防止 (DLP):** DLPツールを導入し、機密データが不正に外部へ送信されるのを監視・ブロックする。
- [ ] **データマスキング:** 本番データをテスト環境などで利用する際に、機密情報を匿名化・仮名化する。

---

### **5. 脆弱性管理とセキュリティテスト**
継続的な脆弱性の発見、評価、修正プロセスを確立します。

**スキャンと評価**
- [ ] **定期的な脆弱性スキャン:** `Nessus`, `Qualys`, `OpenVAS`などのツールで、ネットワークやホストの脆弱性を定期的にスキャンする。
- [ ] **CVSSスコアに基づく優先順位付け:** 発見された脆弱性をCVSSスコアや環境リスクに応じて評価し、修正の優先順位を決定する。
- [ ] **サプライチェーン管理:** SBOM (Software Bill of Materials) を生成・管理し、サードパーティ製ライブラリの脆弱性を継続的にチェックする（例: Dependabot）。

**パッチ管理**
- [ ] **自動パッチ適用:** WSUS (Windows) や `yum/apt` + Ansible (Linux) などで、セキュリティパッチの適用を自動化する。
- [ ] **パッチ適用プロセスの確立:** パッチ適用前の影響評価、適用手順、ロールバック手順を文書化し、管理する。

**能動的なテスト**
- [ ] **ペネトレーションテスト:** 年1回以上、専門家によるペネトレーションテストを実施し、未知の脅威経路を発見する。
- [ ] **設定監査とレビュー:** IaC (Infrastructure as Code) のコードを静的解析ツール（例: `Checkov`, `tfsec`）でレビューし、設定ミスを早期に発見する。

---

### **6. 監視とインシデント対応**
セキュリティイベントをリアルタイムで検知し、迅速かつ効果的に対応する体制を構築します。

**ログ管理と監視**
- [ ] **ログの集中管理:** `Syslog-ng`や`Fluentd`で各種ログをSIEM（例: Splunk, ELK Stack, Graylog）に集約し、改ざん防止策を施す。
- [ ] **リアルタイムアラート:** SIEMや監視ツール（例: Prometheus/Grafana）でセキュリティインシデントに繋がりうるイベント（例: ログイン失敗の多発、CPU使用率の異常）を検知し、アラートを発行する。
- [ ] **脅威インテリジェンスの統合:** SIEMに脅威インテリジェンスフィードを統合し、既知の攻撃パターンとの相関分析を行う。

**インシデント対応**
- [ ] **インシデント対応計画 (IRP) の策定:** 検知、分析、封じ込め、根絶、復旧、事後対応の各フェーズにおける手順と責任者を明確にする。
- [ ] **緊急連絡体制の整備:** インシデント発生時の報告ルートと連絡網を整備し、定期的に訓練を行う。
- [ ] **フォレンジック準備:** インシデント発生に備え、証拠保全の手順を定め、必要なツール（メモリダンプツールなど）を準備しておく。
- [ ] **自動対応・隔離:** EDRやSOAR（Security Orchestration, Automation, and Response）ツールを活用し、脅威が検知されたエンドポイントをネットワークから自動で隔離する。

---

### **7. DevSecOpsと自動化**
CI/CDパイプラインと構成管理にセキュリティを組み込みます。

**CI/CDパイプラインへの統合**
- [ ] **SAST (静的解析):** IaCコード（Terraform, Ansible）やスクリプトをコミット時に静的解析し、セキュリティ問題を早期に発見する。
- [ ] **コンテナイメージスキャン:** ビルドパイプライン内でコンテナイメージの脆弱性スキャンを自動実行する。
- [ ] **依存関係チェック:** アプリケーションやインフラが利用するライブラリやモジュールの脆弱性を自動でチェックする。
- [ ] **シークレット管理:** パスワードやAPIキーをコードに直接記述せず、`HashiCorp Vault`や`AWS Secrets Manager`などの専門ツールで管理する。

**構成管理の自動化**
- [ ] **セキュアな構成のテンプレート化:** Ansible, Chef, Puppetなどでセキュアなサーバー構成をコード化し、設定のドリフト（意図しない変更）を検知・修正する。
- [ ] **コンプライアンスの自動監査:** `InSpec`や`OpenSCAP`などのツールで、サーバー構成がセキュリティポリシーに準拠しているかを継続的にテストする。

---

### **【追加項目】 アプリケーションセキュリティ**

インフラ基盤の堅牢化に加え、その上で動作するアプリケーション自体のセキュリティを確保するための項目です。

---

### **11. バックエンド・APIセキュリティ**
サーバーサイドのコードとAPIエンドポイントを保護し、データとビジネスロジックの脆弱性をなくします。

**APIと入力値の検証**
- [ ] **厳格な入力値バリデーション:** 全てのユーザー入力（リクエストボディ、パラメータ、ヘッダー）に対し、型、長さ、形式、範囲をサーバーサイドで厳格に検証する。
- [ ] **SQLインジェクション対策:** プリペアドステートメント（バインド変数）を徹底し、ORマッパーを安全に使用する。動的にSQLクエリを組み立てない。
- [ ] **コマンドインジェクション対策:** 外部コマンドを呼び出す際に、ユーザー入力を引数として渡さない。やむを得ない場合は厳密にエスケープ処理を行う。
- [ ] **SSRF (Server-Side Request Forgery) 対策:** ユーザーが指定したURLにサーバーがリクエストを送信する機能では、許可リスト（Allowlist）に基づいて接続先を厳しく制限する。
- [ ] **安全なエラーハンドリング:** 詳細なシステム情報、スタックトレース、デバッグメッセージなどを本番環境のエラーレスポンスに含めない。汎用的なエラーメッセージを返す。
- [ ] **レートリミットとリソース制限:** 認証エンドポイントや負荷の高いAPIにレートリミットを設け、ブルートフォース攻撃やDoS攻撃を防ぐ。

**認証・認可**
- [ ] **エンドポイントごとの認可チェック:** 全てのAPIエンドポイントで、リクエストを実行しようとしているユーザーが適切な権限を持っているかを必ず検証する。
- [ ] **オブジェクトレベルのアクセス制御 (IDOR対策):** `GET /api/orders/101` のようなリクエストで、認証済みユーザーが注文ID `101` を閲覧する権限を持つかを検証する。「BOLA (Broken Object Level Authorization)」とも呼ばれる。
- [ ] **JWT (JSON Web Token) の安全な利用:** 強力な署名アルゴリズム（例: `RS256`）を使用し、有効期限を短く設定する。`alg: none`を許可しない。

**ビジネスロジックとファイル処理**
- [ ] **安全でないデシリアライゼーション対策:** 信頼できないソースからのデータを安易にデシリアライズしない。
- [ ] **安全なファイルアップロード:** ファイルの拡張子とMIMEタイプをサーバーサイドで検証し、ファイル名を無害なものに変換する。アップロードされたファイルはWebルートディレクトリ外の安全な場所に保存し、実行権限を与えない。
- [ ] **ビジネスロジックの脆弱性対策:** アプリケーションの正常なワークフロー（例: 購入プロセス、パスワードリセット）を悪用できないか多角的に検証する。

---

### **12. フロントエンドセキュリティ (クライアントサイド)**
ユーザーのブラウザ上で実行されるコードを保護し、ユーザーを攻撃から守ります。

**脆弱性対策**
- [ ] **XSS (クロスサイトスクリプティング) 対策:**
    - **出力のエスケープ:** React, Vue.jsなどのフレームワークが提供する自動エスケープ機能を活用し、`dangerouslySetInnerHTML`のような危険な機能は避ける。
    - **Content Security Policy (CSP):** `Content-Security-Policy` HTTPヘッダーを設定し、信頼できるスクリプトやリソースのソースを制限する。
- [ ] **CSRF (クロスサイトリクエストフォージェリ) 対策:**
    - **CSRFトークン:** 状態を変更するリクエスト（例: `POST`, `PUT`, `DELETE`）には、サーバーが発行したCSRFトークンを要求する。
    - **SameSite Cookie属性:** Cookieに `SameSite=Lax` または `Strict` を設定し、クロスサイトでのCookie送信を制限する。
- [ ] **クリックジャッキング対策:** `X-Frame-Options` ヘッダーやCSPの `frame-ancestors` ディレクティブを設定し、第三者のサイトによるiframe内での表示を禁止する。

**API通信と依存関係の管理**
- [ ] **CORS (Cross-Origin Resource Sharing) の適切な設定:** APIサーバーのCORS設定で、許可するオリジン（ドメイン）をワイルドカード (`*`) ではなく、具体的に指定する。
- [ ] **サードパーティライブラリの脆弱性管理:** `npm audit` や `yarn audit` をCI/CDパイプラインに組み込み、依存関係の脆弱性を継続的にチェックする。
- [ ] **Subresource Integrity (SRI) の利用:** CDNなど外部から読み込むJavaScriptやCSSファイルに `integrity` 属性を付与し、改ざんを検知する。

**機密情報の取り扱い**
- [ ] **クライアントサイドへの機密情報保存の禁止:** APIキー、シークレット、トークンなどの機密情報をJavaScriptコードにハードコーディングしたり、`localStorage` に保存したりしない。
- [ ] **BFF (Backend For Frontend) の活用:** 必要に応じてBFFパターンを導入し、フロントエンドからのリクエストを一度バックエンドで受け、機密情報の付与や複雑な処理を行ってから外部APIと通信する。

---

### **13. セキュア開発ライフサイクル (Secure SDLC)**
開発の初期段階からリリース、運用までの全プロセスにセキュリティを組み込みます。

**設計とレビュー**
- [ ] **脅威モデリング:** 設計段階でアプリケーションの潜在的な脅威（例: STRIDEモデル）を洗い出し、対策を設計に反映させる。
- [ ] **セキュアコーディングガイドラインの策定:** チーム内で統一されたセキュアコーディング規約を定め、定期的に教育を行う。
- [ ] **セキュリティ観点でのコードレビュー:** プルリクエストのレビュープロセスに、必ずセキュリティ観点のチェック項目を含める。

**自動化テスト**
- [ ] **SAST (静的アプリケーションセキュリティテスト):** CI/CDパイプラインに `SonarQube` や `Snyk Code` などのSASTツールを統合し、コードのコミット時に脆弱性を自動検出する。
- [ ] **DAST (動的アプリケーションセキュリティテスト):** テスト環境にデプロイされたアプリケーションに対し、`OWASP ZAP` などのDASTツールを用いて外部からスキャンを実行する。
- [ ] **依存関係スキャン:** CI/CDパイプラインに `OWASP Dependency-Check` などのツールを組み込み、サードパーティライブラリの既知の脆弱性を継続的に監視する。
