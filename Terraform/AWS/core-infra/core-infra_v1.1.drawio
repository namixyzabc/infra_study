<?xml version="1.0" encoding="UTF-8"?> <mxfile host="app.diagrams.net" modified="2025-12-03T00:00:00.000Z" agent="5.0 (compatible)" etag="1" version="20.7.3" type="device"> <diagram id="diagram0" name="Page-1"> <mxGraphModel dx="995" dy="651" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0"> <root> <mxCell id="0"/> <mxCell id="1" parent="0"/>
    <!-- VPC Group -->
    <mxCell id="vpc_group" value="VPC: ${local.name} (10.0.0.0/16)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F7FA;strokeColor=#2B4A76;fontSize=12;fontColor=#06203A" vertex="1" parent="1">
      <mxGeometry x="40" y="40" width="1160" height="760" as="geometry"/>
    </mxCell>

    <!-- Internet Gateway -->
    <mxCell id="igw" value="Internet Gateway (igw)" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#0B5394;fontSize=11" vertex="1" parent="vpc_group">
      <mxGeometry x="540" y="60" width="200" height="40" as="geometry"/>
    </mxCell>

    <!-- Public Route Table -->
    <mxCell id="rt_public" value="Public Route Table" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#6AA84F;fontSize=11" vertex="1" parent="vpc_group">
      <mxGeometry x="820" y="60" width="200" height="40" as="geometry"/>
    </mxCell>

    <!-- AZ 1 group -->
    <mxCell id="az1_group" value="AZ: ${azs[0]}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#999999;fontSize=11" vertex="1" parent="vpc_group">
      <mxGeometry x="60" y="130" width="360" height="620" as="geometry"/>
    </mxCell>

    <!-- AZ2 group -->
    <mxCell id="az2_group" value="AZ: ${azs[1]}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#999999;fontSize=11" vertex="1" parent="vpc_group">
      <mxGeometry x="420" y="130" width="360" height="620" as="geometry"/>
    </mxCell>

    <!-- AZ3 group -->
    <mxCell id="az3_group" value="AZ: ${azs[2]}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#999999;fontSize=11" vertex="1" parent="vpc_group">
      <mxGeometry x="780" y="130" width="360" height="620" as="geometry"/>
    </mxCell>

    <!-- Public subnet AZ1 -->
    <mxCell id="pub_subnet_1" value="Public Subnet A (cidr)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EEF7FF;strokeColor=#2B8CFF;fontSize=11" vertex="1" parent="az1_group">
      <mxGeometry x="20" y="20" width="320" height="120" as="geometry"/>
    </mxCell>

    <!-- Private subnet AZ1 -->
    <mxCell id="priv_subnet_1" value="Private Subnet A (cidr)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF7E6;strokeColor=#E69138;fontSize=11" vertex="1" parent="az1_group">
      <mxGeometry x="20" y="160" width="320" height="400" as="geometry"/>
    </mxCell>

    <!-- Public subnet AZ2 -->
    <mxCell id="pub_subnet_2" value="Public Subnet B (cidr)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EEF7FF;strokeColor=#2B8CFF;fontSize=11" vertex="1" parent="az2_group">
      <mxGeometry x="20" y="20" width="320" height="120" as="geometry"/>
    </mxCell>

    <!-- Private subnet AZ2 -->
    <mxCell id="priv_subnet_2" value="Private Subnet B (cidr)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF7E6;strokeColor=#E69138;fontSize=11" vertex="1" parent="az2_group">
      <mxGeometry x="20" y="160" width="320" height="400" as="geometry"/>
    </mxCell>

    <!-- Public subnet AZ3 -->
    <mxCell id="pub_subnet_3" value="Public Subnet C (cidr)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EEF7FF;strokeColor=#2B8CFF;fontSize=11" vertex="1" parent="az3_group">
      <mxGeometry x="20" y="20" width="320" height="120" as="geometry"/>
    </mxCell>

    <!-- Private subnet AZ3 -->
    <mxCell id="priv_subnet_3" value="Private Subnet C (cidr)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF7E6;strokeColor=#E69138;fontSize=11" vertex="1" parent="az3_group">
      <mxGeometry x="20" y="160" width="320" height="400" as="geometry"/>
    </mxCell>

    <!-- NAT Gateway in Public Subnet A (single NAT Gateway) -->
    <mxCell id="nat_gw" value="NAT Gateway" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#BF9000;fontSize=11" vertex="1" parent="pub_subnet_1">
      <mxGeometry x="40" y="20" width="120" height="60" as="geometry"/>
    </mxCell>

    <!-- Elastic IP (associated with NAT) -->
    <mxCell id="eip" value="Elastic IP (EIP) - NAT" style="shape=ellipse;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#666666;fontSize=10" vertex="1" parent="pub_subnet_1">
      <mxGeometry x="180" y="20" width="120" height="60" as="geometry"/>
    </mxCell>

    <!-- Internet Gateway edge to Public RT -->
    <mxCell id="edge_igw_rt" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999" edge="1" parent="vpc_group" source="igw" target="rt_public">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>

    <!-- Route: Public RT -> Internet Gateway -->
    <mxCell id="edge_rt_igw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999;endArrow=block;endSize=8" edge="1" parent="vpc_group" source="rt_public" target="igw">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>

    <!-- ECS Cluster (Fargate) group - spans private subnets -->
    <mxCell id="ecs_group" value="ECS Cluster (Fargate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#7F3F98;fontSize=12;fontColor=#3E1F4A" vertex="1" parent="vpc_group">
      <mxGeometry x="260" y="240" width="640" height="320" as="geometry"/>
    </mxCell>

    <!-- Fargate tasks placeholder in private subnets -->
    <mxCell id="fargate_task_1" value="Fargate Task\n(Private Subnet A)" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#F2F9F3;strokeColor=#6AA84F;fontSize=11" vertex="1" parent="ecs_group">
      <mxGeometry x="40" y="40" width="180" height="80" as="geometry"/>
    </mxCell>

    <mxCell id="fargate_task_2" value="Fargate Task\n(Private Subnet B)" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#F2F9F3;strokeColor=#6AA84F;fontSize=11" vertex="1" parent="ecs_group">
      <mxGeometry x="230" y="40" width="180" height="80" as="geometry"/>
    </mxCell>

    <mxCell id="fargate_task_3" value="Fargate Task\n(Private Subnet C)" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#F2F9F3;strokeColor=#6AA84F;fontSize=11" vertex="1" parent="ecs_group">
      <mxGeometry x="420" y="40" width="180" height="80" as="geometry"/>
    </mxCell>

    <!-- Service Discovery (Cloud Map) -->
    <mxCell id="service_discovery" value="Service Discovery\n(AWS Cloud Map Private DNS Namespace)" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#0B5394;fontSize=11" vertex="1" parent="vpc_group">
      <mxGeometry x="520" y="570" width="300" height="80" as="geometry"/>
    </mxCell>

    <!-- Edge: Fargate tasks -> Service Discovery -->
    <mxCell id="edge_task1_sd" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#444444;endArrow=block;endSize=8" edge="1" parent="ecs_group" source="fargate_task_1" target="service_discovery">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="edge_task2_sd" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#444444;endArrow=block;endSize=8" edge="1" parent="ecs_group" source="fargate_task_2" target="service_discovery">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="edge_task3_sd" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#444444;endArrow=block;endSize=8" edge="1" parent="ecs_group" source="fargate_task_3" target="service_discovery">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>

    <!-- NAT Gateway route edge: Private subnets -> NAT (via route) -->
    <mxCell id="edge_priv1_nat" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999;dashed=1;endArrow=block;endSize=8" edge="1" parent="vpc_group" source="priv_subnet_1" target="nat_gw">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="edge_priv2_nat" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999;dashed=1;endArrow=block;endSize=8" edge="1" parent="vpc_group" source="priv_subnet_2" target="nat_gw">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="edge_priv3_nat" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999;dashed=1;endArrow=block;endSize=8" edge="1" parent="vpc_group" source="priv_subnet_3" target="nat_gw">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>

    <!-- Edge: Public subnets -> Public Route Table -->
    <mxCell id="edge_pub1_rt" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999" edge="1" parent="vpc_group" source="pub_subnet_1" target="rt_public">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="edge_pub2_rt" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999" edge="1" parent="vpc_group" source="pub_subnet_2" target="rt_public">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>
    <mxCell id="edge_pub3_rt" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#999999" edge="1" parent="vpc_group" source="pub_subnet_3" target="rt_public">
      <mxGeometry relative="1" as="geometry"/>
    </mxCell>

    <!-- Module: VPC outputs (visual only) -->
    <mxCell id="outputs_box" value="Outputs: vpc_id, public_subnets, private_subnets, cluster_arn" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#888888;fontSize=10" vertex="1" parent="vpc_group">
      <mxGeometry x="40" y="720" width="1160" height="60" as="geometry"/>
    </mxCell>

    <!-- Labels for modules: ECS Module -->
    <mxCell id="ecs_module_label" value="module.ecs_cluster (terraform-aws-modules/ecs/aws)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=none;fontSize=10;fontColor=#555555" vertex="1" parent="ecs_group">
      <mxGeometry x="10" y="10" width="200" height="18" as="geometry"/>
    </mxCell>

    <!-- Labels for VPC module -->
    <mxCell id="vpc_module_label" value="module.vpc (terraform-aws-modules/vpc/aws)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=none;fontSize=10;fontColor=#555555" vertex="1" parent="vpc_group">
      <mxGeometry x="20" y="14" width="260" height="18" as="geometry"/>
    </mxCell>

  </root>
</mxGraphModel>
</diagram>
</mxfile>
