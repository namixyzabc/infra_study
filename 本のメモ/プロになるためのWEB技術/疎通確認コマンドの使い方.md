# **疎通確認コマンドの使い方**

## **1\. ping \- ネットワーク接続確認**

`bash`  
`# 基本的な接続確認`  
`ping example.com`

`# 回数を指定`  
`ping -c 4 example.com`

`# 結果例`  
`PING example.com (93.184.216.34): 56 data bytes`  
`64 bytes from 93.184.216.34: icmp_seq=0 ttl=56 time=12.345 ms`  
確認できること: サーバーまでの基本的な接続性、応答時間、パケットロス

## **2\. nslookup \- DNS名前解決確認**

`bash`  
`# ドメイン名からIPアドレスを確認`  
`nslookup example.com`

`# 特定のDNSサーバーを指定`  
`nslookup example.com 8.8.8.8`

`# 結果例`  
`Server:    192.168.1.1`  
`Address:   192.168.1.1#53`

`Name:      example.com`  
`Address:   93.184.216.34`  
確認できること: DNS名前解決の可否、IPアドレス、使用中のDNSサーバー

## **3\. nc \- ポート疎通確認**

`bash`  
`# 特定ポートの疎通確認（スキャンモード）`  
`nc -zv example.com 80`  
`nc -zv example.com 443`

`# 複数ポートを一度に確認`  
`nc -zv example.com 80-85`

`# タイムアウト設定`  
`nc -zv -w 3 example.com 22`

`# 結果例`  
`Connection to example.com port 80 [tcp/http] succeeded!`  
確認できること: 特定ポートへの接続可否、サービスの稼働状況

## **疎通確認の手順とベストプラクティス**

### **段階的確認手順**

`bash`  
`# 1. DNS解決確認`  
`nslookup target-server.com`

`# 2. 基本接続確認`  
`ping -c 4 target-server.com`

`# 3. 特定サービスのポート確認`  
`nc -zv target-server.com 80    # HTTP`  
`nc -zv target-server.com 443   # HTTPS`  
`nc -zv target-server.com 22    # SSH`

### **その他の有用なコマンド**

#### **traceroute/tracepath**

`bash`  
`# 経路確認`  
`traceroute example.com`  
`tracepath example.com`

#### **telnet**

`bash`  
`# ポート接続テスト（対話的）`  
`telnet example.com 80`

#### **curl（アプリケーションレベル）**

`bash`  
`# HTTP/HTTPS疎通確認`  
`curl -I -m 10 https://example.com`  
`curl -v --connect-timeout 5 https://example.com`

#### **ss/netstat**

`bash`  
`# ローカルポート確認`  
`ss -tuln | grep :80`  
`netstat -tuln | grep :80`

## **包括的な疎通確認スクリプト例**

`bash`  
**`#!/bin/bash`**  
`TARGET="example.com"`  
`PORT="80"`

`echo "=== DNS確認 ==="`  
`nslookup $TARGET`

`echo -e "\n=== Ping確認 ==="`  
`ping -c 3 $TARGET`

`echo -e "\n=== ポート確認 ==="`  
`nc -zv -w 5 $TARGET $PORT`

`echo -e "\n=== HTTP確認 ==="`  
`curl -I -m 10 http://$TARGET`

## **推奨される疎通確認の順序**

* DNS確認 → nslookup  
* ネットワーク層確認 → ping  
* トランスポート層確認 → nc  
* アプリケーション層確認 → curl/telnet  
* 経路確認（問題がある場合）→ traceroute

この順序で確認することで、どの層で問題が発生しているかを特定できます。  
