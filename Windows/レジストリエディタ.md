
### 1. レジストリとは何か？

Windowsを理解する上で非常に重要な要素が「レジストリ」です。レジストリエディタを学ぶ前に、まずはその編集対象であるレジストリそのものについて理解を深めましょう。

#### 1.1. レジストリの役割 - Windowsの巨大な設定データベース

レジストリとは、一言で言えば**Windowsオペレーティングシステム（OS）とアプリケーションソフトウェアの設定情報を一元的に格納・管理するためのデータベース**です。コンピュータの心臓部や頭脳に例えられることもあり、Windowsの動作に関するあらゆる情報がここに記録されています。

具体的には、以下のような情報が格納されています。

*   **ハードウェアの設定:**
    *   接続されているデバイス（マウス、キーボード、プリンターなど）の種類や設定。
    *   どのドライバ（※）をいつ読み込むかといった情報。
*   **ソフトウェアの設定:**
    *   インストールされているアプリケーションの一覧。
    *   各アプリケーションのウィンドウサイズ、位置、ユーザー設定など。
    *   どのファイルをどのアプリケーションで開くかという「関連付け」の情報。
*   **ユーザーごとの設定:**
    *   デスクトップの壁紙やスクリーンセーバーの種類。
    *   エクスプローラーの表示設定。
    *   各ユーザーのアカウント情報やパスワードに関する情報（暗号化されています）。
*   **OS自体の設定:**
    *   Windowsの起動やシャットダウンに関する挙動。
    *   システムのパフォーマンスに関する微細な調整項目。
    *   セキュリティに関するポリシー。

> **※単語解説：ドライバ（デバイスドライバ）**
> パソコンに接続されたハードウェア（周辺機器）を、OSが認識して制御するためのソフトウェアです。プリンターを使うためにはプリンタードライバ、グラフィックボードの性能を最大限に引き出すためにはグラフィックスドライバが必要になります。

#### 1.2. なぜレジストリが必要になったのか？

レジストリが登場する以前のWindows（Windows 3.1など）では、設定情報は主に「INIファイル（`.ini`）」というテキストファイルに保存されていました。アプリケーションごとにINIファイルが作られ、Windowsディレクトリなどに散在していました。

この方式にはいくつかの問題点がありました。

*   **管理の煩雑さ:** 設定ファイルがシステム内に散らばるため、どこに何の設定があるのか把握しにくく、管理が大変でした。
*   **パフォーマンスの低下:** アプリケーション起動時に多数の小さなファイルを読み書きする必要があり、パフォーマンスのボトルネックになることがありました。
*   **一貫性の欠如:** 設定の記述方法に統一されたルールがなく、破損しやすいという問題もありました。

これらの問題を解決するために、Windows 95から導入されたのがレジストリです。設定情報を**階層構造を持つ単一のデータベース**に集約することで、高速なアクセスと一元的な管理を実現しました。

#### 1.3. レジストリの重要性と危険性

レジストリはWindowsの動作の根幹をなすため、非常に重要です。しかし、それは同時に**非常にデリケートで危険な場所**でもあることを意味します。

レジストリの値を誤って変更したり、必要なキーを削除したりすると、以下のような深刻な問題が発生する可能性があります。

*   特定のアプリケーションが起動しなくなる。
*   ハードウェアが正常に認識されなくなる。
*   Windowsが起動しなくなる（最悪の場合）。

このため、レジストリを編集するツールである「レジストリエディタ」の利用には、細心の注意が必要です。**編集を行う前には、必ずバックアップを取る習慣をつけましょう。**

### 2. レジストリエディタの起動方法

レジストリエディタ（`regedit.exe`）は、Windowsに標準で搭載されているツールです。いくつかの方法で起動できます。

*   **方法1：ファイル名を指定して実行（最も一般的）**
    1.  キーボードの **`Windows` キー + `R` キー** を同時に押します。
    2.  「ファイル名を指定して実行」ダイアログが表示されます。
    3.  名前の入力欄に `regedit` と入力し、`OK` ボタンを押すか `Enter` キーを押します。
    4.  「ユーザーアカウント制御（UAC）」の画面が表示されたら、「はい」をクリックします。

*   **方法2：スタートメニューの検索ボックスから**
    1.  スタートボタンをクリックするか、`Windows` キーを押します。
    2.  検索ボックスに `regedit` または「レジストリエディタ」と入力します。
    3.  検索結果に表示された「レジストリエディタ」をクリックします。

*   **方法3：コマンドプロンプトやPowerShellから**
    1.  コマンドプロンプトまたはPowerShellを起動します。
    2.  `regedit` と入力して `Enter` キーを押します。

### 3. レジストリエディタの画面構成

レジストリエディタを起動すると、シンプルな2ペイン構成のウィンドウが表示されます。これはエクスプローラーによく似ています。

*   **左ペイン（ツリービュー）:**
    *   レジストリの**キー**がフォルダのような階層構造（ツリー構造）で表示されます。
    *   `+`（または `>`）マークをクリックすると、下位のキーが展開されます。

*   **右ペイン（リストビュー）:**
    *   左ペインで選択したキーに含まれる**値**の一覧が表示されます。
    *   値は「名前」「種類」「データ」の3つの列で構成されています。

*   **アドレスバー:**
    *   ウィンドウの上部には、現在選択しているキーのパスが表示されます。
    *   エクスプローラーのアドレスバーと同様に、ここに直接キーのパスをコピー＆ペーストして移動することもでき、非常に便利です。

*   **メニューバー:**
    *   「ファイル」「編集」「表示」「お気に入り」「ヘルプ」といったメニューがあります。
    *   レジストリのインポート/エクスポート（バックアップ/復元）や検索などの機能はここから実行します。

### 4. レジストリの基本構造：キーと値

レジストリは「キー」と「値」という2つの基本要素で構成されています。

#### 4.1. キー (Key)

*   **役割:** 情報を整理するための**フォルダのようなもの**です。キーの中にさらに別のキー（サブキー）を作成でき、階層構造を形成します。
*   **表現:** キーの場所は、`\`（バックスラッシュ、または円記号）で区切られたパス形式で表現されます。
    *   例: `HKEY_CURRENT_USER\Software\Microsoft\Windows`

#### 4.2. 値 (Value)

*   **役割:** 実際に設定データが格納されている**ファイルのようなもの**です。キーの中に作成されます。
*   **構成要素:** 値は以下の3つの要素で構成されています。
    1.  **名前 (Name):** 値を識別するための名前です。
    2.  **種類 (Type):** 格納されるデータの種類（文字列、数値など）を定義します。詳細は後述します。
    3.  **データ (Data):** 実際の設​​定内容そのものです。

*   **(既定)の値 (Default Value):**
    *   各キーには、必ず「(既定)」という名前の値が一つ存在します。これは特別な値で、名前を省略した場合に参照されます。
    *   データが「(値の設定なし)」となっている場合も多く、必ずしも使われるわけではありません。

### 5. レジストリの主要なデータ型

値には、格納するデータの性質に応じていくつかの「型」があります。レジストリエディタで値を新規作成する際には、適切なデータ型を選択する必要があります。

*   **REG_SZ (文字列値):**
    *   最も一般的なデータ型で、固定長のテキスト（文字列）を格納します。
    *   ファイルパス、説明文、設定名など、さまざまな用途で使われます。
    *   例: `C:\Program Files\MyApp\app.exe`

*   **REG_EXPAND_SZ (展開可能な文字列値):**
    *   `REG_SZ`と似ていますが、**環境変数**（例: `%SystemRoot%`, `%USERPROFILE%`）を含むことができるのが特徴です。
    *   この値がプログラムから読み込まれる際、環境変数は実際のパスに展開（変換）されます。
    *   例: `%SystemRoot%\System32` は、通常 `C:\Windows\System32` として解釈されます。

*   **REG_BINARY (バイナリ値):**
    *   生のバイナリデータ（0と1の羅列）を16進数形式で格納します。
    *   人間が直接読んで理解するのは困難です。主にハードウェアの構成情報や、プログラムが直接利用するデータなどが格納されます。

*   **REG_DWORD (32ビット値):**
    *   **32ビット長の数値**を格納します。非常に多用されるデータ型です。
    *   用途は多彩で、以下のようなものがあります。
        *   **ブール値（真偽値）:** `0`（偽/無効）または `1`（真/有効）として、機能のON/OFFを切り替えるフラグとして使われます。
        *   **数値設定:** タイムアウト時間（ミリ秒）、最大接続数など、特定の数値を設定します。
    *   編集時には10進数と16進数を切り替えて入力できます。

*   **REG_QWORD (64ビット値):**
    *   **64ビット長の数値**を格納します。`REG_DWORD`よりも大きな数値を扱えます。
    *   64ビット版のWindowsで、より大きなデータやメモリアドレスを扱う際に使用されます。

*   **REG_MULTI_SZ (複数文字列値):**
    *   **複数の文字列**を1つの値の中に格納できます。
    *   レジストリエディタ上では、各文字列が改行されて表示されます。プログラム内部ではNULL文字で区切られています。
    *   複数のサービス依存関係や、リスト形式のデータを格納するのに使われます。

### 6. ルートキー (Root Keys) の詳細解説

レジストリエディタの左ペインの最上位には、常に5つのフォルダ（キー）が表示されています。これらを**ルートキー**または**定義済みキー**と呼びます。Windowsのすべてのレジストリデータは、この5つのキーのいずれかの下に属します。

これら5つのキーは独立しているように見えますが、実際には**`HKEY_LOCAL_MACHINE` (HKLM) と `HKEY_USERS` (HKU) が物理的な実体**であり、他の3つはこれらの一部を分かりやすく見せるための**エイリアス（別名）または仮想的なビュー**です。

---

#### `HKEY_CLASSES_ROOT` (HKCR)

*   **役割:** ファイルの**拡張子とアプリケーションの関連付け**や、COM（※）コンポーネントに関する情報を管理します。
    *   例えば、`.txt` ファイルをダブルクリックするとメモ帳が起動するのは、このキーにその関連付けが定義されているためです。
*   **実体:** このキーは仮想的なビューであり、実際には以下の2つのキーの内容を**マージ（統合）して表示**したものです。
    1.  `HKEY_LOCAL_MACHINE\Software\Classes` （全ユーザー共通の設定）
    2.  `HKEY_CURRENT_USER\Software\Classes` （現在ログオンしているユーザー固有の設定）
*   **優先順位:** もし両方の場所に同じ設定が存在する場合、**ユーザー固有の設定（HKCU側）が優先**されます。これにより、管理者によって設定された標準の関連付けを、各ユーザーが自分の好みに合わせて上書きできます。

> **※単語解説：COM (Component Object Model)**
> Microsoftが提唱した、ソフトウェア部品（コンポーネント）を再利用するための技術仕様です。多くのアプリケーションが内部でこの技術を利用しており、そのための情報がレジストリに登録されています。

---

#### `HKEY_CURRENT_USER` (HKCU)

*   **役割:** **現在ログオンしているユーザーに固有の設定**を格納します。
    *   デスクトップの壁紙、スクリーンセーバー、スタートメニューのピン留め、各アプリケーションの個人設定（ツールバーの配置など）といった、ユーザーごとに異なる設定がここに保存されます。
*   **実体:** このキーもエイリアスです。実際には、`HKEY_USERS` キーの下にある、**現在ログオンしているユーザーのSID（※）キーへのショートカット（リンク）**です。
*   Windowsに別のユーザーでログオンすると、`HKEY_CURRENT_USER` が指し示す先がそのユーザーのSIDキーに切り替わるため、常に「今使っているユーザー」の設定にアクセスできます。

> **※単語解説：SID (セキュリティ識別子)**
> Windowsが各ユーザーやグループを一意に識別するために割り当てる、可変長の文字列です（例: `S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxx-1001`）。

---

#### `HKEY_LOCAL_MACHINE` (HKLM)

*   **役割:** コンピュータ全体に適用される、**ハードウェアやソフトウェアの構成情報**を格納します。この設定は、どのユーザーがログオンしても共通です。
*   **実体:** これは物理的なレジストリハイブ（後述）に対応する、**レジストリの本体の一つ**です。
*   HKLMは、主に以下の重要なサブキーで構成されています。
    *   **SAM (Security Accounts Manager):** ローカルユーザーアカウントやグループのデータベース情報が格納されています。セキュリティ上、通常はAdministrators権限でも直接アクセスすることはできません。
    *   **SECURITY:** ローカルセキュリティポリシー（パスワードの長さなど）が格納されています。SAMと同様に通常はアクセスできません。
    *   **SOFTWARE:** **インストールされているアプリケーションの全ユーザー共通の設定**が格納されます。32ビットアプリケーションは `Wow6432Node` というサブキーの下に格納されることが多いです。
    *   **SYSTEM:** **Windowsの起動に不可欠なシステム設定**が格納されます。デバイスドライバの読み込み順序や、サービスの起動設定など、システムの根幹に関わる情報が含まれています。

---

#### `HKEY_USERS` (HKU)

*   **役割:** **そのコンピュータに存在するすべてのユーザープロファイル**に関するレジストリ情報を格納します。
*   **実体:** HKLMと並ぶ、もう一つの**レジストリの本体**です。
*   中には、`.DEFAULT`（どのユーザープロファイルにも属さない場合のデフォルト設定）や、各ユーザーのSIDに対応するサブキーが並んでいます。前述の通り、`HKEY_CURRENT_USER` は、この中のいずれかのSIDキーを指しています。

---

#### `HKEY_CURRENT_CONFIG` (HKCC)

*   **役割:** コンピュータの起動時に使用される**現在のハードウェアプロファイル**に関する情報を格納します。
    *   ハードウェアプロファイルとは、ノートPCをドッキングステーションに接続している場合と、していない場合とで異なるデバイス設定を使い分ける、といったための機能です（最近のWindowsではあまり使われません）。
*   **実体:** これもエイリアスであり、実際には以下のキーへのショートカットです。
    *   `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Hardware Profiles\Current`

### 7. レジストリエディタの基本操作

レジストリエディタの操作は慎重に行う必要がありますが、基本的な手順は難しくありません。

#### 7.1. ナビゲーション（キーへの移動）

*   **ツリービューで探す:** 左ペインのキーをマウスでクリックして階層をたどります。
*   **アドレスバーを使う（推奨）:** Webサイトなどで紹介されているキーのパスをコピーし、レジストリエディタのアドレスバーに貼り付けて `Enter` キーを押すのが最も速く確実です。

#### 7.2. 検索機能

1.  `Ctrl + F` キーを押すか、メニューの「編集」>「検索」を選択します。
2.  検索ダイアログで、探したい文字列を入力します。
3.  「検索する場所」で「キー」「値」「データ」のどれを対象にするかチェックを入れます。（通常はすべてチェックしたままで問題ありません）
4.  「次を検索」ボタンをクリックすると、最初に見つかった場所に移動します。
5.  **`F3` キーを押す**と、同じ条件で次の候補を検索できます。

#### 7.3. キーの作成・名前の変更・削除

*   **作成:**
    1.  親となるキーを右クリックします。
    2.  コンテキストメニューから「新規」>「キー」を選択します。
    3.  「新しいキー #1」という名前でキーが作成されるので、任意の名前に変更します。
*   **名前の変更:**
    1.  対象のキーを右クリックし、「名前の変更」を選択するか、キーを選択して `F2` キーを押します。
*   **削除:**
    1.  対象のキーを右クリックし、「削除」を選択します。
    2.  **警告:** キーを削除すると、そのキーに含まれるすべてのサブキーと値も削除されます。**元に戻すことはできない**ため、実行には細心の注意が必要です。

#### 7.4. 値の作成・変更・削除

*   **作成:**
    1.  値を作成したいキーを左ペインで選択します。
    2.  右ペインの何もない場所を右クリックします。
    3.  「新規」から、作成したい値の種類（文字列値、DWORD (32ビット) 値など）を選択します。
    4.  「新しい値 #1」が作成されるので、名前を入力し `Enter` キーで確定します。
    5.  作成した値をダブルクリックして、データを入力します。
*   **変更:**
    1.  変更したい値をダブルクリックするか、右クリックして「修正」を選択します。
    2.  データ編集ダイアログで新しいデータを入力し、「OK」をクリックします。
*   **削除:**
    1.  対象の値を右クリックし、「削除」を選択します。

#### 7.5. お気に入り機能

頻繁にアクセスするキーは、ブラウザのブックマークのように「お気に入り」に登録しておくと便利です。
*   **登録:** 登録したいキーを選択し、メニューの「お気に入り」>「お気に入りに追加」を選択します。
*   **アクセス:** メニューの「お気に入り」に登録したキーの一覧が表示されるので、クリックするだけでその場所に移動できます。

#### 7.6. エクスポート（バックアップ）

**レジストリを編集する前に行う最も重要な作業です。**

*   **特定のキーをバックアップする場合:**
    1.  バックアップしたいキー（またはその親キー）を左ペインで選択します。
    2.  そのキーを右クリックし、「エクスポート」を選択します。
    3.  保存場所とファイル名（例: `backup_explorer.reg`）を指定して保存します。
    4.  「エクスポート範囲」が「選択した部分」になっていることを確認してください。

*   **レジストリ全体をバックアップする場合:**
    1.  左ペインの「コンピューター」を選択します。
    2.  メニューの「ファイル」>「エクスポート」を選択します。
    3.  保存場所とファイル名を指定して保存します。
    4.  「エクスポート範囲」が「すべて」になっていることを確認します。
    5.  （注意）ファイルサイズが数百MBと非常に大きくなります。通常は、変更する箇所だけをバックアップする方が効率的です。

#### 7.7. インポート（復元）

エクスポートした `.reg` ファイルを使って、レジストリを元の状態に戻します。

*   **方法1：ファイルをダブルクリック**
    1.  バックアップした `.reg` ファイルをエクスプローラー上でダブルクリックします。
    2.  確認のダイアログが表示されるので、「はい」をクリックします。
*   **方法2：レジストリエディタから**
    1.  レジストリエディタを起動します。
    2.  メニューの「ファイル」>「インポート」を選択します。
    3.  バックアップした `.reg` ファイルを選択し、「開く」をクリックします。

**警告:** 信頼できないソースから入手した `.reg` ファイルを安易にインポートしないでください。悪意のあるコードが含まれている場合、システムに深刻なダメージを与える可能性があります。

### 8. 実践的なレジストリ編集の例

ここでは、比較的安全で、変更の効果が分かりやすいレジストリ編集の例をいくつか紹介します。**必ず事前にバックアップ（エクスポート）を取ってから試してください。**

---

#### 例1：コンテキストメニューに「メモ帳で開く」を追加する

あらゆるファイルの右クリックメニューに「メモ帳で開く」という項目を追加し、素早くファイルの内容を確認できるようにします。

1.  **バックアップ:** `HKEY_CLASSES_ROOT\*` キーをエクスポートしておきます。
2.  **移動:** レジストリエディタのアドレスバーに以下を貼り付けて移動します。
    `HKEY_CLASSES_ROOT\*\shell`
3.  **キーの作成:**
    *   左ペインの `shell` キーを右クリックし、「新規」>「キー」を選択します。
    *   キーの名前を `Open with Notepad` など、分かりやすい半角英数字の名前にします（これが内部的な名前になります）。
4.  **表示名の設定:**
    *   今作成した `Open with Notepad` キーを選択します。
    *   右ペインの「(既定)」の値をダブルクリックします。
    *   「値のデータ」に、メニューに表示したい名前を入力します。例: `メモ帳で開く(&N)`
        *   `(&N)` のように `&` とアルファベットを付けると、それがアクセスキー（ショートカットキー）になります。
5.  **コマンドの作成:**
    *   左ペインで、先ほど作成した `Open with Notepad` キーを右クリックし、「新規」>「キー」を選択します。
    *   キーの名前を `command` にします（**この名前は固定です**）。
6.  **コマンドの設定:**
    *   今作成した `command` キーを選択します。
    *   右ペインの「(既定)」の値をダブルクリックします。
    *   「値のデータ」に、以下の文字列を入力します。
        `notepad.exe "%1"`
        *   `notepad.exe` は起動するプログラムです。
        *   `"%1"` は、右クリックしたファイルのパスに置き換えられる特殊なプレースホルダです。
7.  **確認:**
    *   レジストリエディタを閉じます。
    *   デスクトップ上の適当なファイル（画像ファイルや実行ファイルなど）を右クリックし、「メモ帳で開く(N)」というメニューが追加されていれば成功です。それを選択すると、そのファイルがメモ帳で開かれます。

**元に戻すには:** 作成した `Open with Notepad` キーを削除するか、バックアップした `.reg` ファイルをインポートします。

---

#### 例2：エクスプローラーのナビゲーションウィンドウから「3D オブジェクト」を非表示にする

Windows 10/11のエクスプローラーのナビゲーションウィンドウに表示される「3D オブジェクト」フォルダは、使わない人にとっては邪魔な存在です。これを非表示にします。

*   **注意:** この操作はOSのバージョンによってキーの場所が異なる場合があります。ここでは64ビット版Windowsを想定します。

1.  **バックアップ:** `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace` キーをエクスポートしておきます。
2.  **移動:** レジストリエディタのアドレスバーに以下を貼り付けて移動します。
    `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace`
3.  **キーの検索と削除:**
    *   `NameSpace` キーの下に `{...}` という形式のGUID（※）名を持つキーがいくつかあります。
    *   その中から、`{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}` という名前のキーを探します。
    *   見つけたら、そのキーを**右クリックして「削除」**します。
4.  **移動（32bitアプリ用）:** 次に、以下のアドレスに移動します。
    `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace`
5.  **キーの検索と削除（32bitアプリ用）:**
    *   こちらにも同様に `{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}` があれば、それも削除します。
6.  **確認:**
    *   エクスプローラーを開き直すか、PCを再起動すると、「3D オブジェクト」がナビゲーションウィンドウから消えているはずです。

> **※単語解説：GUID (Globally Unique Identifier)**
> ソフトウェアコンポーネントなどを一意に識別するために使用される128ビットの数値です。`{...}` の形式で表現されます。

**元に戻すには:** バックアップした `.reg` ファイルをインポートします。

### 9. .REG ファイルの構造と活用

`.reg` ファイルは、レジストリ情報をテキスト形式で保存したファイルです。その構造を理解すると、自分で設定ファイルを作成して、複数のPCに同じ設定を適用したり、設定の変更を自動化したりできます。

#### 9.1. .REG ファイルの基本書式

`.reg` ファイルは、以下のルールに従って記述します。

1.  **ヘッダー:**
    *   ファイルの先頭は、必ず `Windows Registry Editor Version 5.00` という行で始めます。

2.  **空行:**
    *   ヘッダーとキー定義の間には、必ず空行を1行入れます。

3.  **キーのパス:**
    *   変更対象のキーのパスを `[` と `]` で囲んで記述します。
    *   例: `[HKEY_CURRENT_USER\Software\MyCoolApp]`

4.  **値の定義:**
    *   キーのパスの下に、そのキーに設定したい値を記述します。
    *   `(既定)` の値を設定する場合は、`@` を使います。
    *   書式はデータ型によって異なります。
        *   **文字列 (REG_SZ):** `"値の名前"="文字列データ"`
            *   例: `"UserName"="Taro Yamada"`
            *   例(既定): `@="Default Value"`
        *   **DWORD (REG_DWORD):** `"値の名前"=dword:16進数の値`
            *   例: `"ShowStatusBar"=dword:00000001` （10進数の 1）
        *   **バイナリ (REG_BINARY):** `"値の名前"=hex:16進数データ（カンマ区切り）`
            *   例: `"WindowPosition"=hex:1a,00,2b,00,ff,ff,ff,ff`
        *   **展開可能文字列 (REG_EXPAND_SZ):** `"値の名前"=hex(2):文字列のバイナリ表現`
        *   **複数文字列 (REG_MULTI_SZ):** `"値の名前"=hex(7):文字列のバイナリ表現`
            *   `hex(2)` や `hex(7)` は複雑なので、通常はレジストリエディタでエクスポートしたものを参考にします。

5.  **キーの削除:**
    *   キー全体を削除するには、キーのパスの前に `-`（マイナス）を付けます。
    *   例: `[-HKEY_CURRENT_USER\Software\UnwantedApp]`

6.  **値の削除:**
    *   特定の値だけを削除するには、値の名前の後の `=` の右辺に `-` を置きます。
    *   例: `"ObsoleteValue"=-`

#### 9.2. .REG ファイルの作成例

前述の「メモ帳で開く」を追加する `.reg` ファイルは、テキストエディタで以下のように作成できます。

```reg
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell\Open with Notepad]
@="メモ帳で開く(&N)"

[HKEY_CLASSES_ROOT\*\shell\Open with Notepad\command]
@="notepad.exe \"%1\""
```

この内容をメモ帳などに貼り付け、`add_notepad.reg` のような名前で保存し、ダブルクリックすれば同じ設定が適用されます。

### 10. レジストリ操作の注意点とトラブルシューティング

#### 10.1. 黄金律：編集前のバックアップ

何度でも強調しますが、**レジストリを編集する前には必ずバックアップ**を取ってください。これが最大の安全策です。

*   **システムの復元ポイントの作成:**
    *   レジストリだけでなく、システムファイルもまとめて特定の日時に戻すことができる機能です。
    *   スタートメニューで「復元ポイントの作成」と検索し、設定画面から手動で作成できます。
*   **変更箇所の `.reg` エクスポート:**
    *   最も手軽で確実な方法です。変更するキーだけをエクスポートしておけば、何か問題が起きてもすぐに元に戻せます。

#### 10.2. レジストリ破損時の症状

*   Windowsが起動途中で停止する、またはブルースクリーン（BSoD）が発生する。
*   特定のアプリケーションがエラーを出して起動しない。
*   ユーザープロファイルが読み込めず、一時プロファイルでログオンしてしまう。
*   システムが全体的に不安定になる。

#### 10.3. 修復方法

1.  **バックアップした `.reg` ファイルのインポート:**
    *   システムが起動する状態であれば、これが最も簡単な方法です。

2.  **システムの復元:**
    *   Windowsが起動する場合、または「詳細ブートオプション」から起動できる場合に有効です。問題が発生する前の復元ポイントを選択してシステムを巻き戻します。

3.  **セーフモードでの起動:**
    *   最小限のドライバとサービスだけでWindowsを起動するモードです。
    *   セーフモードで起動できれば、そこで `.reg` ファイルをインポートしたり、システムの復元を実行したりできます。

4.  **高度なスタートアップオプション:**
    *   Windowsの起動に3回失敗すると自動的に表示される回復環境です。
    *   ここから「コマンドプロンプト」を起動し、後述する `reg` コマンドで修復を試みることができます（上級者向け）。

5.  **Windowsの初期化または再インストール:**
    *   上記の方法で解決しない場合の最終手段です。
    *   「このPCを初期状態に戻す」機能を使えば、個人用ファイルを保持したままWindowsを再インストールできますが、アプリケーションはすべて削除されます。

### 11. レジストリに関連する高度なトピック

ここでは、さらに踏み込んだ技術について簡潔に紹介します。

#### 11.1. コマンドラインツール (`reg.exe`)

Windowsには、コマンドプロンプトやバッチファイルからレジストリを操作するための `reg.exe` というコマンドが標準で搭載されています。

*   `reg query [キーパス]`: キーの内容を照会する。
*   `reg add [キーパス] /v [値の名前] /t [データ型] /d [データ]`: 値を追加・変更する。
*   `reg delete [キーパス] /v [値の名前]`: 値を削除する。
*   `reg export [キーパス] [ファイル名]`: キーを `.reg` ファイルにエクスポートする。
*   `reg import [ファイル名]`: `.reg` ファイルをインポートする。

スクリプトで定型的な設定変更を行う際に非常に強力です。

#### 11.2. PowerShellによるレジストリ操作

PowerShellは、`reg.exe` よりもさらに柔軟で強力なレジストリ操作機能を提供します。PowerShellでは、レジストリが**ファイルシステムのようなドライブとして扱われます**。

*   `cd HKCU:`: HKEY_CURRENT_USER に移動する。
*   `ls` または `Get-ChildItem`: 現在のキーのサブキーや値の一覧を表示する。
*   `Get-ItemProperty -Path . -Name "値の名前"`: 値のデータを取得する。
*   `Set-ItemProperty -Path . -Name "値の名前" -Value "新しいデータ"`: 値のデータを設定する。
*   `New-Item -Path "HKCU:\Software" -Name "新しいキー"`: 新しいキーを作成する。

オブジェクト指向で操作できるため、複雑な処理をスクリプト化するのに適しています。

#### 11.3. レジストリハイブファイル (Hive Files)

レジストリは抽象的なデータベースですが、そのデータは**ハイブファイル**という物理的なファイルに保存されています。

*   **システムハイブ:** `C:\Windows\System32\config\` フォルダにあります。
    *   `DEFAULT`, `SAM`, `SECURITY`, `SOFTWARE`, `SYSTEM` といったファイルが、HKLMの各サブキーに対応しています。
*   **ユーザーハイブ:** 各ユーザーのプロファイルフォルダにある `NTUSER.DAT` という隠しファイルです。
    *   ユーザーがログオンすると、このファイルが読み込まれて `HKEY_CURRENT_USER` としてマウントされます。

これらのファイルを知っていると、Windowsが起動しない状態でも、別のOSや回復環境からディスクをマウントし、オフラインでレジストリを編集・修復するといった高度な操作が可能になります。

### 12. まとめ

「Windowsのレジストリエディタ」は、Windowsの内部設定を直接編集できる強力なツールです。

*   レジストリは、**Windowsとアプリの設定情報を一元管理する階層型データベース**です。
*   **キー（フォルダ）**と**値（ファイル）**で構成され、ルートキーを頂点とするツリー構造をしています。
*   `HKLM` はコンピュータ全体の設定、`HKCU` はユーザー固有の設定を管理します。
*   レジストリエディタ (`regedit`) を使うことで、これらの設定を直接、表示・編集・追加・削除できます。
*   その強力さゆえに、誤った操作は**システムに深刻なダメージを与える危険性**をはらんでいます。
*   編集作業を行う前には、**必ずシステムの復元ポイントを作成するか、変更対象のキーを `.reg` ファイルにエクスポートしてバックアップ**を取ってください。

